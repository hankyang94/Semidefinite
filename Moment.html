<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Moment Relaxation | Semidefinite Optimization and Relaxation</title>
  <meta name="description" content="Lecture notes for Harvard ES 257 Semidefinite Optimization and Relaxation." />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Moment Relaxation | Semidefinite Optimization and Relaxation" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Lecture notes for Harvard ES 257 Semidefinite Optimization and Relaxation." />
  <meta name="github-repo" content="hankyang94/Semidefinite" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Moment Relaxation | Semidefinite Optimization and Relaxation" />
  
  <meta name="twitter:description" content="Lecture notes for Harvard ES 257 Semidefinite Optimization and Relaxation." />
  

<meta name="author" content="Heng Yang" />


<meta name="date" content="2024-03-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SOS.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Semidefinite Optimization and Relaxation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#feedback"><i class="fa fa-check"></i>Feedback</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#offerings"><i class="fa fa-check"></i>Offerings</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="notation.html"><a href="notation.html"><i class="fa fa-check"></i>Notation</a></li>
<li class="chapter" data-level="1" data-path="background.html"><a href="background.html"><i class="fa fa-check"></i><b>1</b> Mathematical Background</a>
<ul>
<li class="chapter" data-level="1.1" data-path="background.html"><a href="background.html#background:convexity"><i class="fa fa-check"></i><b>1.1</b> Convexity</a></li>
<li class="chapter" data-level="1.2" data-path="background.html"><a href="background.html#background:convex:geometry"><i class="fa fa-check"></i><b>1.2</b> Convex Geometry</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="background.html"><a href="background.html#basic-facts"><i class="fa fa-check"></i><b>1.2.1</b> Basic Facts</a></li>
<li class="chapter" data-level="1.2.2" data-path="background.html"><a href="background.html#cones-duality-polarity"><i class="fa fa-check"></i><b>1.2.2</b> Cones, Duality, Polarity</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="background.html"><a href="background.html#background:convex:optimization"><i class="fa fa-check"></i><b>1.3</b> Convex Optimization</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="background.html"><a href="background.html#minimax-theorem"><i class="fa fa-check"></i><b>1.3.1</b> Minimax Theorem</a></li>
<li class="chapter" data-level="1.3.2" data-path="background.html"><a href="background.html#background:convex:optimization:Lagrangian"><i class="fa fa-check"></i><b>1.3.2</b> Lagrangian Duality</a></li>
<li class="chapter" data-level="1.3.3" data-path="background.html"><a href="background.html#kkt-optimality-conditions"><i class="fa fa-check"></i><b>1.3.3</b> KKT Optimality Conditions</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="background.html"><a href="background.html#background:linear:optimization"><i class="fa fa-check"></i><b>1.4</b> Linear Optimization</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="background.html"><a href="background.html#polyhedra"><i class="fa fa-check"></i><b>1.4.1</b> Polyhedra</a></li>
<li class="chapter" data-level="1.4.2" data-path="background.html"><a href="background.html#linear-program"><i class="fa fa-check"></i><b>1.4.2</b> Linear Program</a></li>
<li class="chapter" data-level="1.4.3" data-path="background.html"><a href="background.html#farkas-lemma"><i class="fa fa-check"></i><b>1.4.3</b> Farkas Lemma</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sdp.html"><a href="sdp.html"><i class="fa fa-check"></i><b>2</b> Semidefinite Optimization</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sdp.html"><a href="sdp.html#positive-semidefinite-matrices"><i class="fa fa-check"></i><b>2.1</b> Positive Semidefinite Matrices</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="sdp.html"><a href="sdp.html#geometric-properties"><i class="fa fa-check"></i><b>2.1.1</b> Geometric Properties</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="sdp.html"><a href="sdp.html#semidefinite-programming"><i class="fa fa-check"></i><b>2.2</b> Semidefinite Programming</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="sdp.html"><a href="sdp.html#spectrahedra"><i class="fa fa-check"></i><b>2.2.1</b> Spectrahedra</a></li>
<li class="chapter" data-level="2.2.2" data-path="sdp.html"><a href="sdp.html#formulation-and-duality"><i class="fa fa-check"></i><b>2.2.2</b> Formulation and Duality</a></li>
<li class="chapter" data-level="2.2.3" data-path="sdp.html"><a href="sdp.html#geometric-properties-1"><i class="fa fa-check"></i><b>2.2.3</b> Geometric Properties</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="sdp.html"><a href="sdp.html#SoftwareConic"><i class="fa fa-check"></i><b>2.3</b> Software for Conic Optimization</a></li>
<li class="chapter" data-level="2.4" data-path="sdp.html"><a href="sdp.html#interior-point-algorithm"><i class="fa fa-check"></i><b>2.4</b> Interior Point Algorithm</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="sdp.html"><a href="sdp.html#the-central-path"><i class="fa fa-check"></i><b>2.4.1</b> The Central Path</a></li>
<li class="chapter" data-level="2.4.2" data-path="sdp.html"><a href="sdp.html#the-aho-newton-direction"><i class="fa fa-check"></i><b>2.4.2</b> The AHO Newton Direction</a></li>
<li class="chapter" data-level="2.4.3" data-path="sdp.html"><a href="sdp.html#basic-algorithm"><i class="fa fa-check"></i><b>2.4.3</b> Basic Algorithm</a></li>
<li class="chapter" data-level="2.4.4" data-path="sdp.html"><a href="sdp.html#nondegeneracy"><i class="fa fa-check"></i><b>2.4.4</b> Nondegeneracy</a></li>
<li class="chapter" data-level="2.4.5" data-path="sdp.html"><a href="sdp.html#generalization"><i class="fa fa-check"></i><b>2.4.5</b> Generalization</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="sdp.html"><a href="sdp.html#applications"><i class="fa fa-check"></i><b>2.5</b> Applications</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="sdp.html"><a href="sdp.html#LyapunovLinearSystem"><i class="fa fa-check"></i><b>2.5.1</b> Lyapunov Stability</a></li>
<li class="chapter" data-level="2.5.2" data-path="sdp.html"><a href="sdp.html#linear-quadratic-regulator"><i class="fa fa-check"></i><b>2.5.2</b> Linear Quadratic Regulator</a></li>
<li class="chapter" data-level="2.5.3" data-path="sdp.html"><a href="sdp.html#domain-adaptation"><i class="fa fa-check"></i><b>2.5.3</b> Domain Adaptation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Shor.html"><a href="Shor.html"><i class="fa fa-check"></i><b>3</b> Shor’s Semidefinite Relaxation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Shor.html"><a href="Shor.html#semidefinite-relaxation-of-qcqps"><i class="fa fa-check"></i><b>3.1</b> Semidefinite Relaxation of QCQPs</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="Shor.html"><a href="Shor.html#lagrangian-dual-problem"><i class="fa fa-check"></i><b>3.1.1</b> Lagrangian Dual Problem</a></li>
<li class="chapter" data-level="3.1.2" data-path="Shor.html"><a href="Shor.html#dual-of-the-dual-bidual"><i class="fa fa-check"></i><b>3.1.2</b> Dual of the Dual (Bidual)</a></li>
<li class="chapter" data-level="3.1.3" data-path="Shor.html"><a href="Shor.html#maxcut"><i class="fa fa-check"></i><b>3.1.3</b> MAXCUT</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="Shor.html"><a href="Shor.html#certifiably-optimal-rotation-averaging"><i class="fa fa-check"></i><b>3.2</b> Certifiably Optimal Rotation Averaging</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Shor.html"><a href="Shor.html#dual-optimality-certifier"><i class="fa fa-check"></i><b>3.2.1</b> Dual Optimality Certifier</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Shor.html"><a href="Shor.html#stretch-to-high-degree-polynomial-optimization"><i class="fa fa-check"></i><b>3.3</b> Stretch to High-Degree Polynomial Optimization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="SOS.html"><a href="SOS.html"><i class="fa fa-check"></i><b>4</b> Sums of Squares Relaxation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="SOS.html"><a href="SOS.html#basic-algebraic-geometry"><i class="fa fa-check"></i><b>4.1</b> Basic Algebraic Geometry</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="SOS.html"><a href="SOS.html#groups-rings-fields"><i class="fa fa-check"></i><b>4.1.1</b> Groups, Rings, Fields</a></li>
<li class="chapter" data-level="4.1.2" data-path="SOS.html"><a href="SOS.html#polynomials-ideals-and-varieties"><i class="fa fa-check"></i><b>4.1.2</b> Polynomials, Ideals, and Varieties</a></li>
<li class="chapter" data-level="4.1.3" data-path="SOS.html"><a href="SOS.html#gröbner-bases"><i class="fa fa-check"></i><b>4.1.3</b> Gröbner Bases</a></li>
<li class="chapter" data-level="4.1.4" data-path="SOS.html"><a href="SOS.html#quotient-ring"><i class="fa fa-check"></i><b>4.1.4</b> Quotient Ring</a></li>
<li class="chapter" data-level="4.1.5" data-path="SOS.html"><a href="SOS.html#ZeroDimIdeal"><i class="fa fa-check"></i><b>4.1.5</b> Zero-dimensional Ideal</a></li>
<li class="chapter" data-level="4.1.6" data-path="SOS.html"><a href="SOS.html#algebraic-and-semialgebraic-sets"><i class="fa fa-check"></i><b>4.1.6</b> Algebraic and Semialgebraic Sets</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="SOS.html"><a href="SOS.html#sos-and-nonnegative-polynomials"><i class="fa fa-check"></i><b>4.2</b> SOS and Nonnegative Polynomials</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="SOS.html"><a href="SOS.html#nonnegative-polynomials"><i class="fa fa-check"></i><b>4.2.1</b> Nonnegative polynomials</a></li>
<li class="chapter" data-level="4.2.2" data-path="SOS.html"><a href="SOS.html#sums-of-squares-polynomials"><i class="fa fa-check"></i><b>4.2.2</b> Sums-of-Squares Polynomials</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="SOS.html"><a href="SOS.html#compute-sos-decompositions"><i class="fa fa-check"></i><b>4.3</b> Compute SOS Decompositions</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="SOS.html"><a href="SOS.html#univaraite-polynomials"><i class="fa fa-check"></i><b>4.3.1</b> Univaraite Polynomials</a></li>
<li class="chapter" data-level="4.3.2" data-path="SOS.html"><a href="SOS.html#multivariate-polynomials"><i class="fa fa-check"></i><b>4.3.2</b> Multivariate Polynomials</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="SOS.html"><a href="SOS.html#sos-programming"><i class="fa fa-check"></i><b>4.4</b> SOS Programming</a></li>
<li class="chapter" data-level="4.5" data-path="SOS.html"><a href="SOS.html#positivstellensatz"><i class="fa fa-check"></i><b>4.5</b> Positivstellensatz</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="SOS.html"><a href="SOS.html#univaraite-intervals"><i class="fa fa-check"></i><b>4.5.1</b> Univaraite Intervals</a></li>
<li class="chapter" data-level="4.5.2" data-path="SOS.html"><a href="SOS.html#affine-variety"><i class="fa fa-check"></i><b>4.5.2</b> Affine Variety</a></li>
<li class="chapter" data-level="4.5.3" data-path="SOS.html"><a href="SOS.html#basic-semialgebraic-sets"><i class="fa fa-check"></i><b>4.5.3</b> Basic Semialgebraic Sets</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="SOS.html"><a href="SOS.html#applications-1"><i class="fa fa-check"></i><b>4.6</b> Applications</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="SOS.html"><a href="SOS.html#SOS:POP"><i class="fa fa-check"></i><b>4.6.1</b> Polynomial Optimization</a></li>
<li class="chapter" data-level="4.6.2" data-path="SOS.html"><a href="SOS.html#lyapunov-certificates"><i class="fa fa-check"></i><b>4.6.2</b> Lyapunov Certificates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Moment.html"><a href="Moment.html"><i class="fa fa-check"></i><b>5</b> Moment Relaxation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="Moment.html"><a href="Moment.html#dual-cones-of-polynomials"><i class="fa fa-check"></i><b>5.1</b> Dual Cones of Polynomials</a></li>
<li class="chapter" data-level="5.2" data-path="Moment.html"><a href="Moment.html#dual-of-quadratic-modules-and-ideals"><i class="fa fa-check"></i><b>5.2</b> Dual of Quadratic Modules and Ideals</a></li>
<li class="chapter" data-level="5.3" data-path="Moment.html"><a href="Moment.html#the-moment-sos-hierarchy"><i class="fa fa-check"></i><b>5.3</b> The Moment-SOS Hierarchy</a></li>
<li class="chapter" data-level="5.4" data-path="Moment.html"><a href="Moment.html#measure-theoretic-interpretation"><i class="fa fa-check"></i><b>5.4</b> Measure-Theoretic Interpretation</a></li>
<li class="chapter" data-level="5.5" data-path="Moment.html"><a href="Moment.html#truncated-moment-problem"><i class="fa fa-check"></i><b>5.5</b> Truncated Moment Problem</a></li>
<li class="chapter" data-level="5.6" data-path="Moment.html"><a href="Moment.html#flat-extension-detecting-global-optimality-and-extracting-solutions"><i class="fa fa-check"></i><b>5.6</b> Flat Extension: Detecting Global Optimality and Extracting Solutions</a></li>
<li class="chapter" data-level="5.7" data-path="Moment.html"><a href="Moment.html#conversion-to-standard-sdp"><i class="fa fa-check"></i><b>5.7</b> Conversion to Standard SDP</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="Moment.html"><a href="Moment.html#the-first-approach"><i class="fa fa-check"></i><b>5.7.1</b> The First Approach</a></li>
<li class="chapter" data-level="5.7.2" data-path="Moment.html"><a href="Moment.html#the-second-approach"><i class="fa fa-check"></i><b>5.7.2</b> The Second Approach</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Semidefinite Optimization and Relaxation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Moment" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Moment Relaxation<a href="Moment.html#Moment" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the last Chapter, we have learned a lot about polynomials, and in particular, the cone of nonnegative polynomials <span class="math inline">\(P_{n,2d}\)</span>, and the cone of SOS polynomials <span class="math inline">\(\Sigma_{n,2d}\)</span>, with the key inclusion relationship
<span class="math display">\[
\Sigma_{n,2d} \subseteq P_{n,2d}.
\]</span></p>
<p>A natural question is then to characterize the dual of <span class="math inline">\(P_{n,2d}\)</span> and <span class="math inline">\(\Sigma_{n,2d}\)</span>. Let me first restate the dual of a convex set here from Definition <a href="background.html#def:Dual">1.4</a>.</p>
<div class="definitionbox">
<div class="definition">
<p><span id="def:DualConeRestate" class="definition"><strong>Definition 5.1  (Dual Cone) </strong></span>The dual of a convex cone <span class="math inline">\(S\)</span> is
<span class="math display">\[
S^* := \{ y \mid \langle y, x \rangle \geq 0, \forall x \in S \}.
\]</span></p>
</div>
</div>
<div id="dual-cones-of-polynomials" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Dual Cones of Polynomials<a href="Moment.html#dual-cones-of-polynomials" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What are the dual cones of <span class="math inline">\(P_{n,2d}\)</span> and <span class="math inline">\(\Sigma_{n,2d}\)</span>?</p>
<p>For a cone of polynomials, we will first need to define the notion of an inner product in Definition <a href="Moment.html#def:DualConeRestate">5.1</a>, i.e., a map that takes in a polynomial and returns a real number. The space of all such maps is the dual space of <span class="math inline">\(\mathbb{R}[x]_{2d}\)</span>, which we denote <span class="math inline">\(\mathbb{R}[x]^*_{2d}\)</span>. The elements of this vector space are <strong>linear functionals of polynomials</strong>
<span class="math display" id="eq:linear-functional-poly">\[\begin{equation}
\ell: \mathbb{R}[x]_{2d} \rightarrow \mathbb{R}^{}.
\tag{5.1}
\end{equation}\]</span>
There are many such functionals and they can superficially look quite different. Given <span class="math inline">\(p(x) \in \mathbb{R}[x]_{2d}\)</span>, here are some examples of linear functionals:</p>
<ul>
<li><p>Evaluation of <span class="math inline">\(p(x)\)</span> at a point <span class="math inline">\(x_0 \in \mathbb{R}^{n}\)</span>, i.e., <span class="math inline">\(p \mapsto p(x_0)\)</span></p></li>
<li><p>Integration of <span class="math inline">\(p(x)\)</span> over a subset <span class="math inline">\(S \subset \mathbb{R}^{n}\)</span>, i.e., <span class="math inline">\(p \mapsto \int_S p(x) dx\)</span></p></li>
<li><p>Evaluation of derivatives of <span class="math inline">\(p\)</span> at a point <span class="math inline">\(x_0 \in \mathbb{R}^{n}\)</span>, i.e., <span class="math inline">\(p \mapsto \frac{\partial p}{\partial x_i \cdots \partial x_k} (x_0)\)</span></p></li>
<li><p>Extraction of coefficients, i.e., <span class="math inline">\(p \mapsto p_{\alpha}\)</span>, where <span class="math inline">\(p_{\alpha}\)</span> is the coefficient corresponding to the monomial <span class="math inline">\(x^{\alpha}\)</span></p></li>
</ul>
<p>For all the examples above, it is easy to verify linearity
<span class="math display">\[
\ell(p_1 + p_2) = \ell(p_1) + \ell(p_2), \quad \langle \ell, p_1 + p_2 \rangle = \langle \ell, p_1 \rangle + \langle \ell, p_2 \rangle.
\]</span></p>
<p>A distinguished class of linear functionals are the point evaluations (our first example above): given any point <span class="math inline">\(v \in \mathbb{R}^{n}\)</span>, we can generate a linear functional
<span class="math display">\[
\ell_v \in \mathbb{R}[x]^*_{2d}: \ell_v(p) = p(x), \forall p \in \mathbb{R}[x]_{2d}.
\]</span>
Then, we can generate additional linear functionals by taking linear combinations of point evaluations, i.e., maps of the form
<span class="math display">\[
p \mapsto \sum_{i} \lambda_i \ell_{v_i} (p) = \sum_{i} \lambda_i p(v_i), \quad \lambda_i \in \mathbb{R}^{}, v_i \in \mathbb{R}^{n}, \forall i.
\]</span>
It turns out that <em>all</em> linear functionals can be generated in such form.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:DualSpacePoly" class="theorem"><strong>Theorem 5.1  (Dual Space of Polynomials) </strong></span>Every linear functional in <span class="math inline">\(\mathbb{R}[x]^*_{2d}\)</span> is a linear combination of point evaluations, i.e., for any <span class="math inline">\(\ell \in \mathbb{R}[x]^*_{2d}\)</span>, there exists <span class="math inline">\(\lambda_1,\dots,\lambda_K\)</span> and <span class="math inline">\(v_1,\dots,v_K\)</span> such that
<span class="math display">\[
\ell_{p} = \sum_{i=1}^K \lambda_i p(v_i).
\]</span></p>
</div>
</div>
<p><strong>Truncated Multi-Sequence (TMS)</strong>. The above characterization of <span class="math inline">\(\mathbb{R}[x]^*_{2d}\)</span> is purely geometric and coordinate-free. Now we are going to fix the basis of <span class="math inline">\(\mathbb{R}[x]_{2d}\)</span> to be the standard monomial basis <span class="math inline">\([x]_{2d}\)</span> with length <span class="math inline">\(s(n,2d)\)</span>. In this coordinate, any linear functional <span class="math inline">\(\ell\)</span> in <a href="Moment.html#eq:linear-functional-poly">(5.1)</a> can be equivalently identified by its values at the monomial basis, this is
<span class="math display">\[
\ell: \mathbb{R}[x]_{2d} \rightarrow \mathbb{R}^{}, \quad x^{\alpha} \mapsto y_{\alpha}, \alpha \in \mathcal{F}_{n,2d}.
\]</span>
This set of real numbers
<span class="math display">\[
y:=(y_\alpha)_{\alpha \in \mathcal{F}_{n,2d}} \in \mathbb{R}^{s(n,2d)}
\]</span> is called a <strong>truncated multi-sequences</strong> (TMS) of degree <span class="math inline">\(2d\)</span>. Using this TMS <span class="math inline">\(y\)</span>, and denote the linear functional associated with <span class="math inline">\(y\)</span> as <span class="math inline">\(\ell_y \in \mathbb{R}[x]^*_{2d}\)</span>, then applying <span class="math inline">\(\ell_y\)</span> to any polynomial <span class="math inline">\(p \in \mathbb{R}[x]_{2d}\)</span> is simply
<span class="math display">\[
\ell_y(p) = \langle \ell_y, p \rangle = \langle y, \mathrm{vec}(p) \rangle = \sum_{\alpha \in \mathcal{F}_{n,2d}} p_\alpha y_\alpha
\]</span>
i.e., the inner product between the TMS <span class="math inline">\(y\)</span> and the vector of coefficients of <span class="math inline">\(p\)</span>:
<span class="math display">\[
\mathrm{vec}(p) = (p_\alpha)_{\alpha \in \mathcal{F}_{n,2d}}.
\]</span></p>
<p><strong>Moment Matrix</strong>. We now assemble the TMS <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> into symmetric matrices. In particular, for any nonnegative integer <span class="math inline">\(\kappa \in [0,d]\)</span>, the <strong><span class="math inline">\(\kappa\)</span>-th order moment matrix</strong> of the TMS <span class="math inline">\(y\)</span> is a symmetric matrix
<span class="math display">\[
M_\kappa[y]:= [y_{\alpha + \beta}]_{\alpha,\beta \in \mathcal{F}_{n,\kappa}} \in \mathbb{S}^{s(n,\kappa)},
\]</span>
whose rows and columns are indexed by the exponents <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, according to the graded lexicographic monomial ordering. Clearly, if <span class="math inline">\(\kappa_1 \leq \kappa_2\)</span>, then <span class="math inline">\(M_{\kappa_1}[y]\)</span> is a leading principal submatrix of <span class="math inline">\(M_{\kappa_2}[y]\)</span>. Another perspective for looking at the moment matrix is that
<span class="math display">\[
M_{\kappa}[y] = \ell_y ([x]_{\kappa} [x]_{\kappa}^\top) = \langle \ell_y, [x]_{\kappa} [x]_{\kappa}^\top \rangle,
\]</span>
where applying the linear functional <span class="math inline">\(\ell_y\)</span> to the polynomial matrix <span class="math inline">\([x]_{\kappa} [x]_{\kappa}^\top\)</span> is equivalent to element-wise application.</p>
<p>Let’s see some examples.</p>
<div class="examplebox">
<div class="example">
<p><span id="exm:MomentMatrix" class="example"><strong>Example 5.1  (Moment Matrix) </strong></span>Consider the univariate case <span class="math inline">\(n=1\)</span>, and a TMS
<span class="math display">\[
y = (y_0,y_1,\dots,y_{2d}),
\]</span>
the <span class="math inline">\(d\)</span>-th order moment matrix of <span class="math inline">\(y\)</span> is the following matrix
<span class="math display">\[
M_d[y] = \begin{bmatrix}
y_0 &amp; y_1 &amp; y_2 &amp; y_3 &amp; \cdots &amp; y_d \\
y_1 &amp; y_2 &amp; y_3 &amp; y_4 &amp; \cdots &amp; y_{d+1} \\
y_2 &amp; y_3 &amp; y_4 &amp; y_5 &amp; \cdots &amp; y_{d+2} \\
y_3 &amp; y_4 &amp; y_5 &amp; y_6 &amp; \cdots &amp; y_{d+3} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
y_d &amp; y_{d+1} &amp; y_{d+2} &amp; y_{d+3} &amp; \cdots &amp; y_{2d}
\end{bmatrix},
\]</span>
which is also a Hankel matrix.</p>
<p>For the binary case <span class="math inline">\(n=2\)</span> and <span class="math inline">\(d=2\)</span>, we have
<span class="math display">\[
\mathcal{F}_{2,2} = \{ (00),(10),(01),(20),(11),(02) \},
\]</span>
and hence the second-order moment matrix is
<span class="math display" id="eq:example-second-order-moment-mat">\[\begin{equation}
M_2[y] = [y_{\alpha + \beta}]_{\alpha,\beta \in \mathcal{F}_{2,2}} = \begin{bmatrix}
y_{00} &amp; y_{10} &amp; y_{01} &amp; y_{20} &amp; y_{11} &amp; y_{02} \\
y_{10} &amp; y_{20} &amp; y_{11} &amp; y_{30} &amp; y_{21} &amp; y_{12} \\
y_{01} &amp; y_{11} &amp; y_{02} &amp; y_{21} &amp; y_{12} &amp; y_{03} \\
y_{20} &amp; y_{30} &amp; y_{21} &amp; y_{40} &amp; y_{31} &amp; y_{22} \\
y_{11} &amp; y_{21} &amp; y_{12} &amp; y_{31} &amp; y_{22} &amp; y_{13} \\
y_{02} &amp; y_{12} &amp; y_{03} &amp; y_{22} &amp; y_{13} &amp; y_{04}
\end{bmatrix}.
\tag{5.2}
\end{equation}\]</span>
Equivalently, one can check that <span class="math inline">\(M_2[y]\)</span> is equivalent to applying <span class="math inline">\(\ell_y\)</span> to the polynomial matrix <span class="math inline">\([x]_2 [x]_2^\top\)</span>.</p>
</div>
</div>
<p>In general, the moment matrix <span class="math inline">\(M_d[y]\)</span> (given a TMS <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span>) defines a <strong>bilinear form</strong> <span class="math inline">\(\langle \cdot, \cdot \rangle_y\)</span> on <span class="math inline">\(\mathbb{R}[x]_d\)</span>. In particular, given any two polynomials <span class="math inline">\(p,q \in \mathbb{R}[x]_d\)</span>, we have
<span class="math display" id="eq:moment-matrix-bilinear">\[\begin{equation}
\langle p, q \rangle_y := \ell_y(p q) = \langle \mathrm{vec}(p), M_d[y] \mathrm{vec}(q) \rangle = \mathrm{vec}(p)^\top M_d[y] \mathrm{vec}(q).
\tag{5.3}
\end{equation}\]</span>
To see why the equation above is true, note that <span class="math inline">\(p(x) = \mathrm{vec}(p)^\top[x]_d\)</span>, <span class="math inline">\(q(x) = \mathrm{vec}(q)^\top[x]_d\)</span>, so
<span class="math display">\[
\ell_y(pq) = \ell_y(\mathrm{vec}(p)^\top[x]_d [x]_d^\top\mathrm{vec}(q)) = \mathrm{vec}(p)^\top\left( \ell_y ([x]_d [x]_d^\top) \right) \mathrm{vec}(q) = \mathrm{vec}(p)^\top M_d[y] \mathrm{vec}(q).
\]</span></p>
<p><strong>Dual Cone of SOS Polynomials</strong>. With the moment matrix, we can characterize the dual cone of SOS polynomials. Recall that every SOS polynomial of degree up to <span class="math inline">\(2d\)</span> can be written as
<span class="math display">\[
p = [x]_d^\top Q [x]_d,
\]</span>
where <span class="math inline">\(Q \in \mathbb{S}^{s(n,d)}_{+}\)</span> is the associated gram matrix. The dual cone of <span class="math inline">\(\Sigma_{n,d}\)</span> is therefore
<span class="math display">\[
\Sigma_{n,d}^* =  \left\{ y \in \mathbb{R}^{s(n,2d)} \mid \ell_y (p) \geq 0, \forall p \in \Sigma_{n,2d} \right\} .
\]</span>
Now observe that
<span class="math display">\[
\ell_y (p) \geq 0, \forall p \in \Sigma_{n,2d} \Leftrightarrow \ell_y ([x]_d^\top Q [x]_d) \geq 0, \forall Q \succeq 0 \Leftrightarrow \langle Q, M_d[y] \rangle \geq 0, \forall Q \succeq 0 \Leftrightarrow M_d[y] \succeq 0.
\]</span>
Therefore, we conclude that the dual cone to <span class="math inline">\(\Sigma_{n,2d}\)</span> is the moment cone.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:MomentCone" class="theorem"><strong>Theorem 5.2  (Moment Cone) </strong></span>The dual cone to the cone of SOS polynomials is the moment cone
<span class="math display">\[
\Sigma_{n,2d}^* = \mathcal{M}_{n,2d} :=  \left\{ y \in \mathbb{R}^{s(n,2d)} \mid M_d[y] \succeq 0 \right\} .
\]</span></p>
</div>
</div>
<p><strong>Dual Cone of Nonnegative Polynomials</strong>. The dual cone to the cone of nonnegative polynomials is
<span class="math display">\[
P_{n,2d}^* =  \left\{ y \in \mathbb{R}^{s(n,2d)} \mid \langle \mathrm{vec}(p), y \rangle \geq 0, \forall p \in P_{n,2d} \right\} .
\]</span>
To describe the dual cone, we consider the conic hull
<span class="math display" id="eq:dual-cone-nonnegative">\[\begin{equation}
\mathcal{R}_{n,2d} =  \left\{  \sum_{i=1}^K \lambda_i [v_i]_{2d} \mid \lambda_i \geq 0, v_i \in \mathbb{R}^{n}, K \in \mathbb{N} \right\} .
\tag{5.4}
\end{equation}\]</span>
We can clearly see that
<span class="math display">\[
\mathcal{R}_{n,2d} \subseteq P_{n,2d}^*,
\]</span>
because for any <span class="math inline">\(p \in P_{n,2d}\)</span>, we have
<span class="math display">\[
\left\langle \mathrm{vec}(p), \sum_{i=1}^K \lambda_i [v_i]_{2d} \right\rangle = \sum_{i=1}^K \lambda_i \langle \mathrm{vec}(p), [v_i]_{2d} \rangle = \sum_{i=1}^K \lambda_i p(v_i) \geq 0.
\]</span>
It turns out the closure of <span class="math inline">\(\mathcal{R}_{n,2d}\)</span> is the dual cone of nonnegative polynomials.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:DualConeNonnegative" class="theorem"><strong>Theorem 5.3  (Dual Cone of Nonnegative Polynomials) </strong></span>The dual cone of <span class="math inline">\(P_{n,2d}\)</span> is the closure of <span class="math inline">\(\mathcal{R}_{n,2d}\)</span>:
<span class="math display">\[
P_{n,2d}^* = \mathrm{cl}(\mathcal{R}_{n,2d}), \quad \mathcal{R}_{n,2d}^* = P_{n,2d}.
\]</span></p>
</div>
</div>
<p>The closure is needed can be seen from the following exercise.</p>
<div class="exercisebox">
<div class="exercise">
<p><span id="exr:unlabeled-div-17" class="exercise"><strong>Exercise 5.1  </strong></span>Consider the vector space of univariate quadratic polynomials
<span class="math display">\[
\mathbb{R}[x]_2 =  \left\{ p_2 x^2 + p_1 x + p_0 \mid (p_2,p_1,p_0) \in \mathbb{R}^{3} \right\} .
\]</span></p>
<ul>
<li><p>Express the linear functional
<span class="math display">\[
p_2 x^2 + p_1 x + p_0 \mapsto p_2
\]</span>
as a linear combination of point evaluations. (Hint: consider <span class="math inline">\(p(0) = p_0\)</span>, <span class="math inline">\(p(1)=p_2 + p_1 + p_0\)</span>, <span class="math inline">\(p(-1) = p_2 - p_1 + p_0\)</span>. )</p></li>
<li><p>Show that this linear functional is in the dual cone <span class="math inline">\(P^*_{1,2}\)</span> but cannot be written as a conic combination of point evaluations.</p></li>
</ul>
</div>
</div>
</div>
<div id="dual-of-quadratic-modules-and-ideals" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Dual of Quadratic Modules and Ideals<a href="Moment.html#dual-of-quadratic-modules-and-ideals" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Localizing Matrix</strong>. Let <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> be a truncated multi-sequence (TMS) and <span class="math inline">\(g(x) \in \mathbb{R}[x]_{2d}\)</span> be a given polynomial. Let <span class="math inline">\(s\)</span> be the maximum integer such that <span class="math inline">\(2s + \deg(g) \leq 2d\)</span>, then the <span class="math inline">\(d\)</span>-th order <strong>localizing matrix</strong> of <span class="math inline">\(g\)</span> generated by <span class="math inline">\(y\)</span> is the following symmetric matrix
<span class="math display" id="eq:localizing-matrix">\[\begin{equation}
L_{g}^d [y] = \ell_y\left( g(x)\cdot [x]_s [x]_s^\top\right),
\tag{5.5}
\end{equation}\]</span>
where the application of the linear functional <span class="math inline">\(\ell_y\)</span> to the symmetric polynomial matrix <span class="math inline">\(g(x) \cdot [x]_s [x]_s^\top\)</span> is element-wise. For example, let <span class="math inline">\(g = 1- x_1^2 - x_2^2\)</span>, then
<span class="math display">\[\begin{equation}
\begin{split}
g\cdot [x]_1 [x]_1^\top=&amp;  (1-x_1^2 - x_2^2) \begin{bmatrix} 1 &amp; x_1 &amp; x_2 \\
x_1 &amp; x_1^2 &amp; x_1 x_2 \\
x_2 &amp; x_1 x_2 &amp; x_2^2 \end{bmatrix} \\
= &amp; \begin{bmatrix} 1 - x_1^2 - x_2^2 &amp; x_1 - x_1^3 - x_1 x_2^2 &amp; x_2 - x_1^2 x_2 - x_2^3 \\
x_1 - x_1^3 - x_1 x_2^2 &amp; x_1^2 - x_1^4 - x_1^2 x_2^2 &amp; x_1 x_2 - x_1^3 x_2 - x_1 x_2^3 \\
x_2 - x_1^2 x_2 - x_2^3 &amp; x_1 x_2 - x_1^3 x_2 - x_1 x_2^3 &amp; x_2^2 - x_1^2 x_2^2 - x_2^4
\end{bmatrix}
\end{split}
\end{equation}\]</span>
and
<span class="math display" id="eq:example-localizing-matrix">\[\begin{equation}
L_g^d[y] = \ell_y (g\cdot [x]_1 [x]_1^\top) = \begin{bmatrix}
y_{00} - y_{20} - y_{02} &amp; y_{10} - y_{30} - y_{12} &amp; y_{01} - y_{21} - y_{03} \\
y_{10} - y_{30} - y_{12} &amp; y_{20} - y_{40} - y_{22} &amp; y_{11} - y_{31} - y_{13} \\
y_{01} - y_{21} - y_{03} &amp;  y_{11} - y_{31} - y_{13} &amp; y_{02} - y_{22} - y_{04}
\end{bmatrix}.
\tag{5.6}
\end{equation}\]</span>
A key observation is that the entries of <span class="math inline">\(L_g^d[y]\)</span> are affine functions of the TMS <span class="math inline">\(y\)</span>.</p>
<p><strong>Dual of Quadratic Module</strong>. Given a tuple of polynomials <span class="math inline">\(g = (g_1,\dots,g_{l_g})\)</span>, recall (from Definition <a href="SOS.html#def:QuadraticModule">4.20</a>) that the quadratic module associated with <span class="math inline">\(g\)</span> is
<span class="math display">\[
\mathrm{Qmodule}[g] :=  \left\{  \sum_{i=0}^{l_g} \sigma_i g_i \mid \sigma_i \in \Sigma[x],i=0,\dots,l_g  \right\}
\]</span>
where <span class="math inline">\(g_0(x):=1\)</span> and <span class="math inline">\(\Sigma[x]\)</span> denotes the set of SOS polynomials. The degree-<span class="math inline">\(2d\)</span> truncation of the quadratic module is
<span class="math display" id="eq:quadratic-module-truncated">\[\begin{equation}
\mathrm{Qmodule}[g]_{2d} :=  \left\{  \sum_{i=0}^{l_g} \sigma_i g_i \mid \sigma_i \in \Sigma[x], \deg(\sigma_i g_i) \leq 2d, i=0,\dots,l_g  \right\} .
\tag{5.7}
\end{equation}\]</span>
Now consider the convex cone defined by the PSD conditions of the localizing matrices:
<span class="math display" id="eq:tms-cone-dual-qmodule">\[\begin{equation}
\mathcal{M}[g]_{2d} :=  \left\{  y \in \mathbb{R}^{s(n,2d)} \mid M_d[y] \succeq 0, L_{g_i}^d[y] \succeq 0, i=1,\dots,l_g \right\} .
\tag{5.8}
\end{equation}\]</span>
The following result shows that <span class="math inline">\(\mathcal{M}[g]_{2d}\)</span> is the dual cone of <span class="math inline">\(\mathrm{Qmodule}[g]_{2d}\)</span>.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:DualQuadratedModule" class="theorem"><strong>Theorem 5.4  (Dual of Quadratic Module) </strong></span>Given a set of polynomials <span class="math inline">\(g=(g_1,\dots,g_{l_g})\)</span>, we have</p>
<ol style="list-style-type: decimal">
<li><p>The cone <span class="math inline">\(\mathcal{M}[g]_{2d}\)</span> is closed and convex, and it is dual to <span class="math inline">\(\mathrm{Qmodule}[g]_{2d}\)</span>, i.e.,
<span class="math display">\[
\langle f, y \rangle \geq 0, \quad \forall f \in \mathrm{Qmodule}[g]_{2d}, y \in \mathcal{M}[g]_{2d}.
\]</span></p></li>
<li><p>If the set <span class="math inline">\(S_{\geq 0} := \{ x \in \mathbb{R}^{n} \mid g_i(x) \geq 0, i=1,\dots,l_g \}\)</span> has nonempty interior, then both <span class="math inline">\(\mathcal{M}[g]_{2d}\)</span> and <span class="math inline">\(\mathrm{Qmodule}[g]_{2d}\)</span> are proper cones (i.e., closed and convex) and they are dual to each other.
<span class="math display">\[
(\mathcal{M}[g]_{2d})^* = \mathrm{Qmodule}[g]_{2d}, \quad (\mathrm{Qmodule}[g]_{2d})^* = \mathcal{M}[g]_{2d}.
\]</span></p></li>
</ol>
</div>
</div>
<p>To see 1 of Theorem <a href="Moment.html#thm:DualQuadratedModule">5.4</a>, pick any <span class="math inline">\(f \in \mathrm{Qmodule}[g]_{2d}\)</span> from <a href="Moment.html#eq:quadratic-module-truncated">(5.7)</a>, and any <span class="math inline">\(y \in \mathcal{M}[g]_{2d}\)</span> from <a href="Moment.html#eq:tms-cone-dual-qmodule">(5.8)</a>, we have
<span class="math display">\[\begin{equation}
\begin{split}
\langle f, y \rangle = &amp; \langle \sigma_0, y \rangle + \sum_{i=1}^{l_g} \langle \sigma_i g_i, y \rangle \\
= &amp; \left\langle [x]_d^\top Q_0 [x]_d, y \right\rangle + \sum_{i=1}^{l_g} \left\langle g_i \cdot [x]_{s_i}^\top Q_i [x]_{s_i}, y \right\rangle \\
= &amp; \left\langle M_d[y], Q_0 \right\rangle + \sum_{i=1}^{l_g} \left\langle L^d_{g_i}[y], Q_i \right\rangle \geq 0
\end{split}
\end{equation}\]</span>
where <span class="math inline">\(Q_0,Q_1,\dots,Q_{l_g}\)</span> are the Gram matrices associated with the SOS multipliers <span class="math inline">\(\sigma_0,\sigma_1,\dots,\sigma_{l_g}\)</span>, and <span class="math inline">\(s_i\)</span> is the maximum integer such that <span class="math inline">\(2 s_i + \deg (g_i) \leq 2d\)</span>. The equation above also shows that, in order for any TMS <span class="math inline">\(y\)</span> to be in the dual cone of <span class="math inline">\(\mathrm{Qmodule}[y]_{2d}\)</span>, it must hold that <span class="math inline">\(M_d[y] \succeq 0, L^d_{g_i}[y] \succeq 0,i=1,\dots,l_g\)</span>, and hence <span class="math inline">\(y\)</span> must belong to <span class="math inline">\(\mathcal{M}_d[y]\)</span>.</p>
<p>To see 2 of Theorem <a href="Moment.html#thm:DualQuadratedModule">5.4</a>, note that when <span class="math inline">\(S_{\geq 0}\)</span> has empty interior, the cone <span class="math inline">\(\mathrm{Qmodule}[g]_{2d}\)</span> may not be closed. For example, consider <span class="math inline">\(g = -x^2\)</span>, the set <span class="math inline">\(S_{\geq 0}\)</span> is the singleton <span class="math inline">\(\{ 0 \}\)</span> and has empty interior. The polynomial <span class="math inline">\(x + \epsilon\)</span>, for any <span class="math inline">\(\epsilon &gt; 0\)</span>, is in <span class="math inline">\(\mathrm{Qmodule}[g]_2\)</span> because
<span class="math display">\[
x + \epsilon = \left( \sqrt{\epsilon} + \frac{x}{2 \sqrt{\epsilon}} \right)^2 + (-x^2) \left( \frac{1}{2 \sqrt{\epsilon}} \right)^2.
\]</span>
However, when <span class="math inline">\(\epsilon = 0\)</span>, the polynomial <span class="math inline">\(x \not\in \mathrm{Qmodule}[x]_{2}\)</span>.</p>
<p><strong>Dual of the Sum of Ideal and Quadratic Module</strong>. Recall that given a tuple of polynomials <span class="math inline">\(h=(h_1,\dots,h_{l_h})\)</span>, the ideal generated by <span class="math inline">\(h\)</span> is
<span class="math display">\[
\mathrm{Ideal}[h] =  \left\{ \sum_{i=1}^{l_h} \lambda_i h_i \mid \lambda_i \in \mathbb{R}[x],i=1,\dots,l_h \right\} ,
\]</span>
where <span class="math inline">\(\lambda_i\)</span> are the polynomial multipliers. Similarly, the degree-<span class="math inline">\(2d\)</span> truncation of <span class="math inline">\(\mathrm{Ideal}[h]\)</span> is
<span class="math display" id="eq:ideal-truncated-2d">\[\begin{equation}
\mathrm{Ideal}[h]_{2d} =  \left\{  \sum_{i=1}^{l_h} \lambda_i h_i \mid \lambda_i \in \mathbb{R}[x], \deg(\lambda_i h_i) \leq 2d,i=1,\dots,l_h \right\} .
\tag{5.9}
\end{equation}\]</span>
For each <span class="math inline">\(\lambda_i \in \mathbb{R}[x]_{2d - \deg(h_i)}\)</span> such that <span class="math inline">\(\deg(\lambda_i h_i) \leq 2d\)</span>, the coefficients of <span class="math inline">\((\lambda_i h_i\)</span> are linear in that of <span class="math inline">\(\lambda_i\)</span>
<span class="math display">\[
\mathrm{vec}(\lambda_i h_i) = H_i^{2d} \mathrm{vec}(\lambda_i),
\]</span>
where <span class="math inline">\(\mathrm{vec}(\cdot)\)</span> denotes the coefficients vector of a polynomial. For example, suppose <span class="math inline">\(h = x^2-1\)</span> and <span class="math inline">\(d = 2\)</span>, then <span class="math inline">\(\lambda(x) = \lambda_2 x^2 + \lambda_1 x + \lambda_0\)</span>, and
<span class="math display">\[
\lambda(x) h(x) = (\lambda_2 x^2 + \lambda_1 x + \lambda_0)(x^2 - 1) = \lambda_2 x^4 + \lambda_1 x^3 + (\lambda_0 - \lambda_2) x^2 - \lambda_1 x - \lambda_0.
\]</span>
Then,
<span class="math display">\[
\mathrm{vec}(\lambda h) = \begin{bmatrix}
- \lambda_0 \\
- \lambda_1 \\
\lambda_0 - \lambda_2 \\
\lambda_1 \\
\lambda_2 \end{bmatrix} =
\underbrace{\begin{bmatrix}
-1 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 0 \\
1 &amp; 0 &amp; -1 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1
\end{bmatrix}}_{H^4}
\begin{bmatrix}
\lambda_0 \\ \lambda_1 \\ \lambda_2 \end{bmatrix}
\]</span></p>
<p><strong>Localizing Vector</strong>. Given a TMS <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> and its associated linear functional <span class="math inline">\(\ell_y\)</span>, applying <span class="math inline">\(\ell_y\)</span> to <span class="math inline">\(\lambda_i h_i\)</span> with <span class="math inline">\(\deg(\lambda_i h_i) \leq 2d\)</span> can be written as
<span class="math display">\[
\ell_y(\lambda_i h_i) = \langle y, \mathrm{vec}(\lambda_i h_i) \rangle = \langle y, H_i^{2d} \mathrm{vec}(\lambda_i) \rangle = \left\langle (H_i^{2d})^\top y, \mathrm{vec}(\lambda_i) \right\rangle,
\]</span>
and the vector
<span class="math display" id="eq:localizing-vector">\[\begin{equation}
L_{h_i}^{2d}[y] := (H_i^{2d})^\top y
\tag{5.10}
\end{equation}\]</span>
is called the <strong>localizing vector</strong> of <span class="math inline">\(h_i\)</span> generated by the TMS <span class="math inline">\(y\)</span>. We are interested in linear functionals that vanish on <span class="math inline">\(\mathrm{Ideal}[h]_{2d}\)</span>. Clearly, this is the subspace
<span class="math display" id="eq:linear-subspace-tms">\[\begin{equation}
\mathcal{Z}[h]_{2d} :=  \left\{ y \in \mathbb{R}^{s(n,2d)} \mid L_{h_i}^{2d}[y] = 0,i=1,\dots,l_h  \right\} .
\tag{5.11}
\end{equation}\]</span></p>
<p>The next result gives the dual of the sum of ideal and quadratic module.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:DualSumIdealQuadraticModule" class="theorem"><strong>Theorem 5.5  (Dual of the Sum of Ideal and Quadratic Module) </strong></span>Let <span class="math inline">\(g=(g_1,\dots,g_{l_g})\)</span> and <span class="math inline">\(h=(h_1,\dots,l_h)\)</span> be tuples of polynomials, for any <span class="math inline">\(2d &gt; 0\)</span>, we have
<span class="math display">\[
\left( \mathrm{Ideal}[h]_{2d} + \mathrm{Qmodule}[g]_{2d} \right)^* = \mathcal{Z}[h]_{2d} \cap \mathcal{M}[g]_{2d}
\]</span>
where <span class="math inline">\(\mathcal{Z}[h]_{2d}\)</span> is the linear subspace in <a href="Moment.html#eq:linear-subspace-tms">(5.11)</a> and <span class="math inline">\(\mathcal{M}[g]_{2d}\)</span> is the convex cone in <a href="Moment.html#eq:tms-cone-dual-qmodule">(5.8)</a>.</p>
</div>
</div>
<p>To see this, pick any element <span class="math inline">\(f \in \mathrm{Ideal}[h]_{2d} + \mathrm{Qmodule}[g]_{2d}\)</span> and any element <span class="math inline">\(y \in \mathcal{Z}[h]_{2d} \cap \mathcal{M}[g]_{2d}\)</span>, perform the inner product
<span class="math display">\[\begin{equation}
\begin{split}
\langle f, \ell_y \rangle = \left\langle \sum_{i=1}^{l_h} \lambda_i h_i + \sum_{i=0}^{l_g} \sigma_i g_i , \ell_y \right\rangle = \sum_{i=1}^{l_h} \langle \mathrm{vec}(\lambda_i h_i), y \rangle + \sum_{i=1}^{l_g} \langle g_i \cdot [x]_{s_i}^\top Q_i [x]_{s_i}, \ell_y \rangle \\
= \sum_{i=1}^{l_h} \langle L_{h_i}^{2d}[y], \mathrm{vec}(\lambda_i) \rangle + \sum_{i=0}^{l_g} \langle L_{g_i}^d[y], Q_i \rangle
\end{split}.
\end{equation}\]</span>
This is clearly nonnegative since <span class="math inline">\(L_{h_i}^{2d}[y] = 0\)</span> and <span class="math inline">\(L_{g_i}^d[y] \succeq 0\)</span> is implied by <span class="math inline">\(y \in \mathcal{Z}[h]_{2d} \cap \mathcal{M}[g]_{2d}\)</span>.</p>
</div>
<div id="the-moment-sos-hierarchy" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> The Moment-SOS Hierarchy<a href="Moment.html#the-moment-sos-hierarchy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In Chapter <a href="SOS.html#SOS:POP">4.6.1</a>, we introduced an SOS relaxation for solving polynomial optimization problems (POPs). In particular, we consider the following POP, restated from <a href="SOS.html#eq:pop">(4.19)</a>
<span class="math display" id="eq:pop-restate">\[\begin{equation}
\begin{split}
p^\star = \min_{x \in \mathbb{R}^{n}} &amp; \quad p(x) \\
\mathrm{s.t.}&amp; \quad h_i(x) = 0, i=1,\dots,l_h \\
&amp; \quad g_i(x) \geq 0, i=1,\dots,l_g
\end{split}
\tag{5.12}
\end{equation}\]</span>
Using Putinar’s Positivstellensatz, for any <span class="math inline">\(\kappa \in \mathbb{N}\)</span>, we have the following SOS program
<span class="math display" id="eq:SOS-Putinar-restate">\[\begin{equation}
\boxed{
\begin{split}
\gamma_{\kappa}^\star = \max &amp; \quad \gamma \\
\mathrm{s.t.}&amp; \quad p(x) - \gamma \in \mathrm{Ideal}[h]_{2\kappa} + \mathrm{Qmodule}[g]_{2\kappa}
\end{split}
}
\tag{5.13}
\end{equation}\]</span>
whose optimal value produces a lower bound to <span class="math inline">\(p^\star\)</span>, i.e., <span class="math inline">\(\gamma_{\kappa}^\star \leq p^\star\)</span>.</p>
<p>With the machinery introduced above on the dual of the cone of polynomials, we can write down the dual problem of the SOS program <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a>
<span class="math display" id="eq:moment-Putinar">\[\begin{equation}
\boxed{
\begin{split}
\beta_{\kappa}^\star = \min_{y \in \mathbb{R}^{s(n,2\kappa)}} &amp; \quad \langle \ell_y, p \rangle \\
\mathrm{s.t.}&amp; \quad y \in \mathcal{Z}[h]_{2\kappa} \cap \mathcal{M}[g]_{2\kappa} \\
&amp; \quad \langle \ell_y, 1 \rangle = 1
\end{split}
}
\tag{5.14}
\end{equation}\]</span>
In problem <a href="Moment.html#eq:moment-Putinar">(5.14)</a>, <span class="math inline">\(\langle \ell_y, p \rangle\)</span> and <span class="math inline">\(\langle \ell_y, 1 \rangle\)</span> should be interpreted as applying the linear functional associated with the TMS <span class="math inline">\(y\)</span> to the polynomial <span class="math inline">\(p\)</span> and the polynomial “<span class="math inline">\(1\)</span>”. As a result, the constraint <span class="math inline">\(\langle \ell_y, 1 \rangle=1\)</span> implies <span class="math inline">\(y_0 = 1\)</span>. To see why <a href="Moment.html#eq:moment-Putinar">(5.14)</a> is the dual of <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a>, pick any <span class="math inline">\(\gamma\)</span> that is feasible for <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a> and any <span class="math inline">\(y\)</span> that is feasible for <a href="Moment.html#eq:moment-Putinar">(5.14)</a>, we have
<span class="math display">\[
\langle \ell_y, p \rangle - \gamma = \langle \ell_y, p \rangle - \langle \ell_y, \gamma \rangle = \langle \ell_y, p - \gamma \rangle \geq 0,
\]</span>
where, again, <span class="math inline">\(\langle \ell_y, \gamma \rangle\)</span> should be interpreted as applying <span class="math inline">\(\ell_y\)</span> to the degree-<span class="math inline">\(0\)</span> polynomial “<span class="math inline">\(\gamma\)</span>”. The last inequality holds because <span class="math inline">\(y\)</span> and <span class="math inline">\(p - \gamma\)</span> live in two cones that are dual to each other. Consequently, we have the weak duality
<span class="math display">\[
\gamma_{\kappa}^\star \leq \beta_{\kappa}^\star, \quad \forall \kappa \in \mathbb{N}.
\]</span>
The pair of SDPs <a href="Moment.html#eq:moment-Putinar">(5.14)</a> and <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a> is called the moment-SOS hierarchy and is first proposed in <span class="citation">(<a href="#ref-lasserre01siopt-global">Lasserre 2001</a>)</span>.</p>
<p>One may wonder how to directly write down the primal problem <a href="Moment.html#eq:moment-Putinar">(5.14)</a> given the dual problem <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a>, or vice versa? In the next we give a brief discussion about general conic duality, from which the primal-dual relationship shall be clear.</p>
<div class="highlightbox">
<p style="text-align: center;">
<b>Conic Duality</b>
</p>
<p>Let <span class="math inline">\(V\)</span> be a vector space and <span class="math inline">\(\mathcal{K}\subset V\)</span> be a proper cone. On the dual side, let <span class="math inline">\(V^*\)</span> be the dual space of <span class="math inline">\(V\)</span> and <span class="math inline">\(\mathcal{K}^*\)</span> be the dual cone of <span class="math inline">\(\mathcal{K}\)</span>. Note that <span class="math inline">\(V^*\)</span>, the dual space to <span class="math inline">\(V\)</span>, is the vector space of real-valued linear functionals. For example,</p>
<ul>
<li><p>if <span class="math inline">\(V=\mathbb{R}^{n}\)</span> (think of this as the space of points), then <span class="math inline">\(V^* = \mathbb{R}^{n}\)</span> (think of this as the space of linear functionals on points).</p></li>
<li><p>if <span class="math inline">\(V = \mathbb{R}[x]_{2d}\)</span> is the space of polynomials of degree up to <span class="math inline">\(2d\)</span> (which is isomorphic to just <span class="math inline">\(\mathbb{R}^{s(n,2d)}\)</span> after identifying each polynomial <span class="math inline">\(f\)</span> with its vector of coefficients <span class="math inline">\(\mathrm{vec}(f)\)</span>), then <span class="math inline">\(V^* = \mathbb{R}[x]_{2d}^*\)</span> is the space of linear functionals (which, again, is isomorphic to just <span class="math inline">\(\mathbb{R}^{s(n,2d)}\)</span> after identifying each linear functional with its associated truncated muti-sequence <span class="math inline">\(y\)</span>).</p></li>
</ul>
<p>For any <span class="math inline">\(x \in V\)</span> and <span class="math inline">\(f \in V^*\)</span>, we can define an inner product <span class="math inline">\(\langle f, x \rangle = f(x)\)</span>, which is simply applying the linear functional <span class="math inline">\(f\)</span> to the point <span class="math inline">\(x\)</span> and returning a real number.</p>
<p>We then consider a linear map <span class="math inline">\(\mathcal{A}: V \rightarrow T\)</span> where <span class="math inline">\(T\)</span> is another vector space. The adjoint map <span class="math inline">\(\mathcal{A}^*: T^* \rightarrow V^*\)</span> is defined via
<span class="math display">\[
\langle x, \mathcal{A}^* y \rangle_V = \langle y, \mathcal{A}x \rangle_T, \quad \forall x \in V, y \in T^*,
\]</span>
where the subscript <span class="math inline">\(V,T\)</span> implies the inner product is written in their respective primal-dual vector spaces.</p>
<p>We can then define the general primal-dual conic pair
<span class="math display" id="eq:conic-primal">\[\begin{equation}
\boxed{
\begin{split}
\min_{x \in V} &amp; \quad \langle c, x \rangle_V \\
\mathrm{s.t.}&amp; \quad \mathcal{A}x = b \\
&amp; \quad x \in \mathcal{K}
\end{split}}
\tag{5.15}
\end{equation}\]</span>
and
<span class="math display" id="eq:conic-dual">\[\begin{equation}
\boxed{
\begin{split}
\max_{y \in T^*} &amp; \quad \langle b, y \rangle_T \\
\mathrm{s.t.}&amp; \quad c - \mathcal{A}^* y \in \mathcal{K}^*
\end{split}}
\tag{5.16}
\end{equation}\]</span>
where <span class="math inline">\(b \in T\)</span> and <span class="math inline">\(c \in V^*\)</span> are given. The proof of weak duality can be done by picking any <span class="math inline">\(x\)</span> feasible for the primal and <span class="math inline">\(y\)</span> feasible for the dual, leading to
<span class="math display">\[\begin{equation}
\begin{split}
\langle c, x \rangle_V - \langle b, y \rangle_T &amp; = \langle c, x \rangle_V - \langle \mathcal{A}x, y \rangle_T \\
&amp; = \langle c, x \rangle_V - \langle x, \mathcal{A}^* y \rangle_V \\
&amp; = \langle c - \mathcal{A}^* y, x \rangle_V \\
&amp; \geq 0
\end{split}
\end{equation}\]</span>
where the last inequality holds because <span class="math inline">\(x \in \mathcal{K}\)</span> and <span class="math inline">\(c - \mathcal{A}^* y \in \mathcal{K}^*\)</span>.</p>
<p>We have seen three instantiations of <a href="Moment.html#eq:conic-primal">(5.15)</a> and <a href="Moment.html#eq:conic-dual">(5.16)</a> so far in the class.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Linear programming</strong> (Chapter <a href="background.html#background:linear:optimization">1.4</a>). With <span class="math inline">\(V = V^* = \mathbb{R}^{n}\)</span>, <span class="math inline">\(T = T^* = \mathbb{R}^{m}\)</span>, <span class="math inline">\(\mathcal{K}= \mathcal{K}^* = \mathbb{R}^{n}_{+}\)</span>, we recover the standard LP pair <a href="background.html#eq:primal-lp">(1.15)</a> and <a href="background.html#eq:dual-lp">(1.16)</a>.</p></li>
<li><p><strong>Semidefinite programming</strong> (Chapter <a href="sdp.html#sdp">2</a>). With <span class="math inline">\(V = V^* = \mathbb{S}^{n}\)</span>, <span class="math inline">\(T = T^* = \mathbb{R}^{m}\)</span>, <span class="math inline">\(\mathcal{K}= \mathcal{K}^* = \mathbb{S}^{n}_{+}\)</span>, we recover the standard SDP pair <a href="sdp.html#eq:SDP-P">(2.5)</a> and <a href="sdp.html#eq:SDP-D">(2.6)</a>.</p></li>
<li><p><strong>Moment-SOS hierarchy</strong>. With</p></li>
</ol>
<ul>
<li><span class="math inline">\(V^* = \mathbb{R}[x]_{2\kappa}\)</span>, <span class="math inline">\(V = \mathbb{R}[x]_{2\kappa}^*\)</span></li>
<li><span class="math inline">\(T = T^* = \mathbb{R}^{}\)</span></li>
<li><span class="math inline">\(\mathcal{K}= \mathcal{Z}[h]_{2\kappa} \cap \mathcal{M}[g]_{2\kappa}\)</span>, and <span class="math inline">\(\mathcal{K}^* = \mathrm{Ideal}[h]_{2\kappa} + \mathrm{Qmodule}[g]_{2\kappa}\)</span></li>
</ul>
<p>From LP to SDP to the moment-SOS hierarchy, this is a (in my opinion, beautiful) sequence of generalizations in conic duality. As we seek higher level of generalization, we have more modelling power (i.e., we can solve harder optimization problems), but we also face more computational challenges (i.e., the convex optimization problems become more expensive to solve).</p>
</div>
<p>The next theorem collects some known results about the moment-SOS hierarchy in terms of asymptotic convergence and strong duality.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:MomentSOSHierarchy" class="theorem"><strong>Theorem 5.6  (Moment-SOS Hierarchy) </strong></span>Consider the POP <a href="Moment.html#eq:pop-restate">(5.12)</a> and the primal-dual pair <a href="Moment.html#eq:moment-Putinar">(5.14)</a> and <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a>, we have
<span class="math display">\[
\gamma_{\kappa}^\star \leq \beta_{\kappa}^\star \leq p^\star, \quad \forall \kappa \in \mathbb{N},
\]</span>
and both sequences <span class="math inline">\(\{ \gamma_{\kappa}^\star \}_{\kappa=1}^{\infty}\)</span>, <span class="math inline">\(\{ \beta_{\kappa}^\star \}_{\kappa=1}^{\infty}\)</span> are monotonically increasing. Moreover, let the feasible set of the POP <a href="Moment.html#eq:pop-restate">(5.12)</a> be <span class="math inline">\(S\)</span>,</p>
<ul>
<li><p>Suppose all equality constraints are linear or there are no equality constraints. If there exists <span class="math inline">\(x_0 \in S\)</span> such that <span class="math inline">\(g_i(x_0) &gt; 0, i=1,\dots,l_g\)</span>, then <span class="math inline">\(\gamma_{\kappa}^\star = \beta_{\kappa}^\star\)</span> for any <span class="math inline">\(\kappa\)</span>, and the dual problem <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a> is solvable (i.e., the maximum is attained).</p></li>
<li><p>Suppose there exists a scalar <span class="math inline">\(R &gt; 0\)</span> such that
<span class="math display">\[
R - \Vert x \Vert^{2\kappa_0} \in \mathrm{Ideal}[h]_{2\kappa_0} + \mathrm{Qmodule}[g]_{2\kappa_0}
\]</span>
for some <span class="math inline">\(\kappa_0 \in \mathbb{N}\)</span>. For any <span class="math inline">\(\kappa \geq \kappa_0\)</span>, if the moment relaxation <a href="Moment.html#eq:moment-Putinar">(5.14)</a> is feasible, then it is solvable (i.e., the minimum is attained).</p></li>
<li><p>If the constraint set is Archimedean, then the moment-SOS hierarchy has asymptotic convergence, i.e.,
<span class="math display">\[
\lim_{\kappa \rightarrow \infty} \gamma_{\kappa}^\star = \lim_{\kappa \rightarrow \infty} \beta_{\kappa}^\star = p^\star.
\]</span></p></li>
<li><p>If <span class="math inline">\(g\)</span> includes a ball constraint <span class="math inline">\(R - \Vert x \Vert^2\)</span>, and the POP feasible set <span class="math inline">\(S\)</span> is nonempty, then <span class="math inline">\(\gamma_{\kappa}^\star = \beta_{\kappa}^\star\)</span> for any <span class="math inline">\(\kappa\)</span>, and the moment relaxation <a href="Moment.html#eq:moment-Putinar">(5.14)</a> is solvable (i.e., the minimum is attained).</p></li>
</ul>
</div>
</div>
<p>The last point in Theorem <a href="Moment.html#thm:MomentSOSHierarchy">5.6</a> is particularly useful for numerical computation. It suggests that adding a redundant ball constraint is always encouraged for strong duality to hold. In addition, an appropriate scaling technique is needed so that all scaled variables belong to the unit ball. Without scaling, numerical troubles can occur.</p>
<p>Without these assumptions and conditions, it is possible that strong duality fails.</p>
<div class="examplebox">
<div class="example">
<p><span id="exm:FailureStrongDualityMomentSOS" class="example"><strong>Example 5.2  (Failure of Strong Duality in Moment-SOS Hierarchy) </strong></span>Consider the following POP
<span class="math display">\[\begin{equation}
\begin{split}
p^\star = \min_{x \in \mathbb{R}^{2}} &amp; \quad x_1 x_2 \\
\mathrm{s.t.}&amp; \quad -1 \leq x_1 \leq 1 \\
&amp; \quad x_2^2 \leq 0
\end{split}
\end{equation}\]</span>
Clearly, the global minimum <span class="math inline">\(p^\star = 0\)</span> and it is attained at <span class="math inline">\((\alpha,0)\)</span> for any <span class="math inline">\(\alpha \in [-1,1]\)</span>. We now implement the moment-SOS hierarchy and see if strong duality holds.</p>
<p>As shown in Example <a href="SOS.html#exm:SOSRelaxation">4.16</a>, the SOS relaxation can be implemented in SOSTOOLS, see <a href="https://github.com/ComputationalRobotics/Semidefinite-Examples/blob/main/example_pop_no_strong_duality.m">this code</a>. Running the code at <span class="math inline">\(\kappa = 1\)</span>, we obtain the following output from MOSEK:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb13-1"><a href="Moment.html#cb13-1" tabindex="-1"></a><span class="va">ITE</span> <span class="va">PFEAS</span>    <span class="va">DFEAS</span>    <span class="va">GFEAS</span>    <span class="va">PRSTATUS</span>   <span class="va">POBJ</span>              <span class="va">DOBJ</span>              <span class="va">MU</span>       <span class="va">TIME</span>  </span>
<span id="cb13-2"><a href="Moment.html#cb13-2" tabindex="-1"></a><span class="fl">0</span>   <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">0.00e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">1.0e+00</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-3"><a href="Moment.html#cb13-3" tabindex="-1"></a><span class="fl">1</span>   <span class="fl">1.5e-01</span>  <span class="fl">1.5e-01</span>  <span class="fl">7.9e-02</span>  <span class="fl">5.56e-01</span>   <span class="fl">3.088172318e-01</span>   <span class="fl">4.050011330e-01</span>   <span class="fl">1.5e-01</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-4"><a href="Moment.html#cb13-4" tabindex="-1"></a><span class="fl">2</span>   <span class="fl">4.1e-02</span>  <span class="fl">4.1e-02</span>  <span class="fl">2.1e-02</span>  <span class="fl">3.13e-01</span>   <span class="fl">5.858768891e-01</span>   <span class="fl">7.658826639e-01</span>   <span class="fl">4.1e-02</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-5"><a href="Moment.html#cb13-5" tabindex="-1"></a><span class="fl">3</span>   <span class="fl">1.1e-02</span>  <span class="fl">1.1e-02</span>  <span class="fl">4.5e-03</span>  <span class="fl">2.25e-01</span>   <span class="fl">4.180497936e-01</span>   <span class="fl">5.431122321e-01</span>   <span class="fl">1.1e-02</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-6"><a href="Moment.html#cb13-6" tabindex="-1"></a><span class="fl">4</span>   <span class="fl">4.2e-03</span>  <span class="fl">4.2e-03</span>  <span class="fl">2.2e-03</span>  <span class="op">-</span><span class="fl">7.15e-02</span>  <span class="fl">7.821867345e-01</span>   <span class="fl">1.021805063e+00</span>   <span class="fl">4.2e-03</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-7"><a href="Moment.html#cb13-7" tabindex="-1"></a><span class="fl">5</span>   <span class="fl">8.7e-04</span>  <span class="fl">8.7e-04</span>  <span class="fl">3.1e-04</span>  <span class="fl">8.58e-02</span>   <span class="fl">3.753027688e-01</span>   <span class="fl">4.921723327e-01</span>   <span class="fl">8.7e-04</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-8"><a href="Moment.html#cb13-8" tabindex="-1"></a><span class="fl">6</span>   <span class="fl">2.0e-04</span>  <span class="fl">2.0e-04</span>  <span class="fl">1.1e-04</span>  <span class="op">-</span><span class="fl">3.30e-02</span>  <span class="fl">8.469613700e-01</span>   <span class="fl">1.114348467e+00</span>   <span class="fl">2.0e-04</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-9"><a href="Moment.html#cb13-9" tabindex="-1"></a><span class="fl">7</span>   <span class="fl">3.6e-05</span>  <span class="fl">3.6e-05</span>  <span class="fl">1.5e-05</span>  <span class="fl">6.62e-02</span>   <span class="fl">5.132062526e-01</span>   <span class="fl">6.764418357e-01</span>   <span class="fl">3.6e-05</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-10"><a href="Moment.html#cb13-10" tabindex="-1"></a><span class="fl">8</span>   <span class="fl">8.5e-06</span>  <span class="fl">8.5e-06</span>  <span class="fl">3.9e-06</span>  <span class="fl">2.07e-02</span>   <span class="fl">6.478873186e-01</span>   <span class="fl">8.551888421e-01</span>   <span class="fl">8.5e-06</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-11"><a href="Moment.html#cb13-11" tabindex="-1"></a><span class="fl">9</span>   <span class="fl">2.3e-06</span>  <span class="fl">2.3e-06</span>  <span class="fl">9.1e-07</span>  <span class="fl">6.40e-02</span>   <span class="fl">5.033974907e-01</span>   <span class="fl">6.654248395e-01</span>   <span class="fl">2.3e-06</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-12"><a href="Moment.html#cb13-12" tabindex="-1"></a><span class="fl">10</span>  <span class="fl">8.0e-07</span>  <span class="fl">8.0e-07</span>  <span class="fl">4.2e-07</span>  <span class="op">-</span><span class="fl">1.66e-01</span>  <span class="fl">8.695267485e-01</span>   <span class="fl">1.150524931e+00</span>   <span class="fl">8.0e-07</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-13"><a href="Moment.html#cb13-13" tabindex="-1"></a><span class="fl">11</span>  <span class="fl">1.7e-07</span>  <span class="fl">1.7e-07</span>  <span class="fl">6.1e-08</span>  <span class="fl">8.16e-02</span>   <span class="fl">3.666850704e-01</span>   <span class="fl">4.865006085e-01</span>   <span class="fl">1.7e-07</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-14"><a href="Moment.html#cb13-14" tabindex="-1"></a><span class="fl">12</span>  <span class="fl">3.8e-08</span>  <span class="fl">3.8e-08</span>  <span class="fl">2.2e-08</span>  <span class="op">-</span><span class="fl">1.05e-01</span>  <span class="fl">1.019156252e+00</span>   <span class="fl">1.353211111e+00</span>   <span class="fl">3.8e-08</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-15"><a href="Moment.html#cb13-15" tabindex="-1"></a><span class="fl">13</span>  <span class="fl">5.8e-09</span>  <span class="fl">5.8e-09</span>  <span class="fl">2.6e-09</span>  <span class="fl">3.57e-02</span>   <span class="fl">5.915896244e-01</span>   <span class="fl">7.859525244e-01</span>   <span class="fl">5.8e-09</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-16"><a href="Moment.html#cb13-16" tabindex="-1"></a><span class="fl">14</span>  <span class="fl">1.4e-09</span>  <span class="fl">1.4e-09</span>  <span class="fl">5.8e-10</span>  <span class="fl">9.40e-02</span>   <span class="fl">5.523832993e-01</span>   <span class="fl">7.340489667e-01</span>   <span class="fl">1.4e-09</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-17"><a href="Moment.html#cb13-17" tabindex="-1"></a><span class="fl">15</span>  <span class="fl">4.3e-10</span>  <span class="fl">4.3e-10</span>  <span class="fl">2.3e-10</span>  <span class="op">-</span><span class="fl">1.39e-01</span>  <span class="fl">8.826739207e-01</span>   <span class="fl">1.173406707e+00</span>   <span class="fl">4.3e-10</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-18"><a href="Moment.html#cb13-18" tabindex="-1"></a><span class="fl">16</span>  <span class="fl">1.1e-10</span>  <span class="fl">1.1e-10</span>  <span class="fl">3.7e-11</span>  <span class="fl">1.31e-01</span>   <span class="fl">3.711852473e-01</span>   <span class="fl">4.939043249e-01</span>   <span class="fl">1.1e-10</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-19"><a href="Moment.html#cb13-19" tabindex="-1"></a><span class="fl">17</span>  <span class="fl">7.0e-11</span>  <span class="fl">2.6e-11</span>  <span class="fl">1.5e-11</span>  <span class="op">-</span><span class="fl">1.55e-01</span>  <span class="fl">1.056341629e+00</span>   <span class="fl">1.406000814e+00</span>   <span class="fl">2.6e-11</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-20"><a href="Moment.html#cb13-20" tabindex="-1"></a><span class="fl">18</span>  <span class="fl">7.1e-12</span>  <span class="fl">4.6e-12</span>  <span class="fl">2.1e-12</span>  <span class="op">-</span><span class="fl">2.75e-03</span>  <span class="fl">6.282269209e-01</span>   <span class="fl">8.364103066e-01</span>   <span class="fl">4.6e-12</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-21"><a href="Moment.html#cb13-21" tabindex="-1"></a><span class="fl">19</span>  <span class="fl">1.5e-12</span>  <span class="fl">9.9e-13</span>  <span class="fl">4.1e-13</span>  <span class="fl">1.33e-01</span>   <span class="fl">5.056202080e-01</span>   <span class="fl">6.732103175e-01</span>   <span class="fl">9.9e-13</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-22"><a href="Moment.html#cb13-22" tabindex="-1"></a><span class="fl">20</span>  <span class="fl">4.2e-13</span>  <span class="fl">2.7e-13</span>  <span class="fl">1.5e-13</span>  <span class="op">-</span><span class="fl">1.07e-01</span>  <span class="fl">8.738865371e-01</span>   <span class="fl">1.163743093e+00</span>   <span class="fl">2.7e-13</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-23"><a href="Moment.html#cb13-23" tabindex="-1"></a><span class="fl">21</span>  <span class="fl">9.4e-14</span>  <span class="fl">6.1e-14</span>  <span class="fl">2.3e-14</span>  <span class="fl">1.05e-01</span>   <span class="fl">4.311662782e-01</span>   <span class="fl">5.743514027e-01</span>   <span class="fl">6.1e-14</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-24"><a href="Moment.html#cb13-24" tabindex="-1"></a><span class="fl">22</span>  <span class="fl">2.4e-14</span>  <span class="fl">1.6e-14</span>  <span class="fl">8.5e-15</span>  <span class="op">-</span><span class="fl">1.21e-01</span>  <span class="fl">8.898674342e-01</span>   <span class="fl">1.185531234e+00</span>   <span class="fl">1.6e-14</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-25"><a href="Moment.html#cb13-25" tabindex="-1"></a><span class="fl">23</span>  <span class="fl">7.1e-15</span>  <span class="fl">5.8e-15</span>  <span class="fl">2.2e-15</span>  <span class="op">-</span><span class="fl">3.77e-02</span>  <span class="fl">6.963438000e-01</span>   <span class="fl">9.278150049e-01</span>   <span class="fl">4.3e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-26"><a href="Moment.html#cb13-26" tabindex="-1"></a><span class="fl">24</span>  <span class="fl">1.2e-15</span>  <span class="fl">7.6e-16</span>  <span class="fl">3.3e-16</span>  <span class="fl">1.78e-01</span>   <span class="fl">5.434018296e-01</span>   <span class="fl">7.241064462e-01</span>   <span class="fl">8.9e-16</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-27"><a href="Moment.html#cb13-27" tabindex="-1"></a><span class="fl">25</span>  <span class="fl">8.9e-16</span>  <span class="fl">1.8e-15</span>  <span class="fl">1.0e-16</span>  <span class="op">-</span><span class="fl">1.35e-01</span>  <span class="fl">6.204719258e-01</span>   <span class="fl">8.268596881e-01</span>   <span class="fl">2.4e-16</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-28"><a href="Moment.html#cb13-28" tabindex="-1"></a><span class="fl">26</span>  <span class="fl">2.2e-16</span>  <span class="fl">4.4e-16</span>  <span class="fl">2.2e-17</span>  <span class="fl">7.87e-02</span>   <span class="fl">5.651101237e-01</span>   <span class="fl">7.531366036e-01</span>   <span class="fl">6.0e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-29"><a href="Moment.html#cb13-29" tabindex="-1"></a><span class="fl">27</span>  <span class="fl">4.4e-16</span>  <span class="fl">2.7e-15</span>  <span class="fl">1.9e-17</span>  <span class="op">-</span><span class="fl">1.32e-01</span>  <span class="fl">5.677222556e-01</span>   <span class="fl">7.566247465e-01</span>   <span class="fl">5.1e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-30"><a href="Moment.html#cb13-30" tabindex="-1"></a><span class="fl">28</span>  <span class="fl">6.5e-17</span>  <span class="fl">3.6e-15</span>  <span class="fl">1.8e-17</span>  <span class="op">-</span><span class="fl">8.42e-02</span>  <span class="fl">5.674944086e-01</span>   <span class="fl">7.563223512e-01</span>   <span class="fl">4.9e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-31"><a href="Moment.html#cb13-31" tabindex="-1"></a><span class="fl">29</span>  <span class="fl">6.0e-17</span>  <span class="fl">2.7e-15</span>  <span class="fl">1.7e-17</span>  <span class="op">-</span><span class="fl">8.28e-02</span>  <span class="fl">5.669921471e-01</span>   <span class="fl">7.556553290e-01</span>   <span class="fl">4.5e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-32"><a href="Moment.html#cb13-32" tabindex="-1"></a><span class="fl">30</span>  <span class="fl">4.4e-16</span>  <span class="fl">2.7e-15</span>  <span class="fl">1.7e-17</span>  <span class="op">-</span><span class="fl">6.79e-02</span>  <span class="fl">5.669663151e-01</span>   <span class="fl">7.556209582e-01</span>   <span class="fl">4.5e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-33"><a href="Moment.html#cb13-33" tabindex="-1"></a><span class="fl">31</span>  <span class="fl">4.4e-16</span>  <span class="fl">2.7e-15</span>  <span class="fl">1.4e-17</span>  <span class="op">-</span><span class="fl">6.99e-02</span>  <span class="fl">5.652526235e-01</span>   <span class="fl">7.533411196e-01</span>   <span class="fl">3.8e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-34"><a href="Moment.html#cb13-34" tabindex="-1"></a><span class="fl">32</span>  <span class="fl">3.0e-17</span>  <span class="fl">8.9e-16</span>  <span class="fl">8.5e-18</span>  <span class="op">-</span><span class="fl">4.43e-02</span>  <span class="fl">5.579125501e-01</span>   <span class="fl">7.435651031e-01</span>   <span class="fl">2.4e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-35"><a href="Moment.html#cb13-35" tabindex="-1"></a><span class="fl">33</span>  <span class="fl">3.0e-17</span>  <span class="fl">8.9e-16</span>  <span class="fl">8.5e-18</span>  <span class="op">-</span><span class="fl">8.34e-03</span>  <span class="fl">5.579035284e-01</span>   <span class="fl">7.435530824e-01</span>   <span class="fl">2.4e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-36"><a href="Moment.html#cb13-36" tabindex="-1"></a><span class="fl">34</span>  <span class="fl">3.0e-17</span>  <span class="fl">8.9e-16</span>  <span class="fl">8.5e-18</span>  <span class="op">-</span><span class="fl">8.34e-03</span>  <span class="fl">5.579035284e-01</span>   <span class="fl">7.435530824e-01</span>   <span class="fl">2.4e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-37"><a href="Moment.html#cb13-37" tabindex="-1"></a><span class="fl">35</span>  <span class="fl">2.5e-17</span>  <span class="fl">1.6e-17</span>  <span class="fl">6.8e-18</span>  <span class="op">-</span><span class="fl">1.15e-02</span>  <span class="fl">5.529270780e-01</span>   <span class="fl">7.369224772e-01</span>   <span class="fl">1.9e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-38"><a href="Moment.html#cb13-38" tabindex="-1"></a><span class="fl">36</span>  <span class="fl">2.5e-17</span>  <span class="fl">2.2e-15</span>  <span class="fl">6.8e-18</span>  <span class="op">-</span><span class="fl">1.79e-03</span>  <span class="fl">5.529095013e-01</span>   <span class="fl">7.368990567e-01</span>   <span class="fl">1.9e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-39"><a href="Moment.html#cb13-39" tabindex="-1"></a><span class="fl">37</span>  <span class="fl">2.5e-17</span>  <span class="fl">2.2e-15</span>  <span class="fl">6.8e-18</span>  <span class="op">-</span><span class="fl">1.79e-03</span>  <span class="fl">5.529095013e-01</span>   <span class="fl">7.368990567e-01</span>   <span class="fl">1.9e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-40"><a href="Moment.html#cb13-40" tabindex="-1"></a><span class="fl">38</span>  <span class="fl">2.5e-17</span>  <span class="fl">2.2e-15</span>  <span class="fl">6.8e-18</span>  <span class="op">-</span><span class="fl">1.76e-03</span>  <span class="fl">5.529007155e-01</span>   <span class="fl">7.368873498e-01</span>   <span class="fl">1.9e-17</span>  <span class="fl">0.00</span>  </span>
<span id="cb13-41"><a href="Moment.html#cb13-41" tabindex="-1"></a><span class="fl">39</span>  <span class="fl">1.1e-17</span>  <span class="fl">4.4e-15</span>  <span class="fl">4.0e-18</span>  <span class="op">-</span><span class="fl">1.74e-03</span>  <span class="fl">5.409849593e-01</span>   <span class="fl">7.210098998e-01</span>   <span class="fl">1.1e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb13-42"><a href="Moment.html#cb13-42" tabindex="-1"></a><span class="fl">40</span>  <span class="fl">1.1e-17</span>  <span class="fl">4.9e-15</span>  <span class="fl">4.0e-18</span>  <span class="fl">1.44e-02</span>   <span class="fl">5.408403061e-01</span>   <span class="fl">7.208171399e-01</span>   <span class="fl">1.1e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb13-43"><a href="Moment.html#cb13-43" tabindex="-1"></a><span class="fl">41</span>  <span class="fl">1.1e-17</span>  <span class="fl">4.9e-15</span>  <span class="fl">4.0e-18</span>  <span class="fl">1.44e-02</span>   <span class="fl">5.408403061e-01</span>   <span class="fl">7.208171399e-01</span>   <span class="fl">1.1e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb13-44"><a href="Moment.html#cb13-44" tabindex="-1"></a><span class="fl">42</span>  <span class="fl">1.1e-17</span>  <span class="fl">4.9e-15</span>  <span class="fl">4.0e-18</span>  <span class="fl">1.44e-02</span>   <span class="fl">5.408403061e-01</span>   <span class="fl">7.208171399e-01</span>   <span class="fl">1.1e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb13-45"><a href="Moment.html#cb13-45" tabindex="-1"></a><span class="va">Optimizer</span> <span class="va">terminated</span>. <span class="va">Time</span><span class="op">:</span> <span class="fl">0.01</span>    </span>
<span id="cb13-46"><a href="Moment.html#cb13-46" tabindex="-1"></a></span>
<span id="cb13-47"><a href="Moment.html#cb13-47" tabindex="-1"></a></span>
<span id="cb13-48"><a href="Moment.html#cb13-48" tabindex="-1"></a><span class="va">Interior</span><span class="op">-</span><span class="va">point</span> <span class="va">solution</span> <span class="va">summary</span></span>
<span id="cb13-49"><a href="Moment.html#cb13-49" tabindex="-1"></a>  <span class="va">Problem</span> <span class="va">status</span>  <span class="op">:</span> <span class="va">UNKNOWN</span></span>
<span id="cb13-50"><a href="Moment.html#cb13-50" tabindex="-1"></a>  <span class="va">Solution</span> <span class="va">status</span> <span class="op">:</span> <span class="va">UNKNOWN</span></span>
<span id="cb13-51"><a href="Moment.html#cb13-51" tabindex="-1"></a>  <span class="va">Primal</span>.  <span class="va">obj</span><span class="op">:</span> <span class="fl">5.4084030611e-01</span>    <span class="va">nrm</span><span class="op">:</span> <span class="fl">3e+08</span>    <span class="va">Viol</span>.  <span class="va">con</span><span class="op">:</span> <span class="fl">1e-09</span>    <span class="va">var</span><span class="op">:</span> <span class="fl">0e+00</span>    <span class="va">barvar</span><span class="op">:</span> <span class="fl">0e+00</span>  </span>
<span id="cb13-52"><a href="Moment.html#cb13-52" tabindex="-1"></a>  <span class="va">Dual</span>.    <span class="va">obj</span><span class="op">:</span> <span class="fl">7.2081713987e-01</span>    <span class="va">nrm</span><span class="op">:</span> <span class="fl">4e+08</span>    <span class="va">Viol</span>.  <span class="va">con</span><span class="op">:</span> <span class="fl">0e+00</span>    <span class="va">var</span><span class="op">:</span> <span class="fl">1e-09</span>    <span class="va">barvar</span><span class="op">:</span> <span class="fl">7e-07</span> </span></code></pre></div>
<p>which shows that the solver did not converge.</p>
<p>If instead, we add a redundant ball constraint <span class="math inline">\(4 - x_1^2 - x_2^2 \geq 0\)</span> and solve again at <span class="math inline">\(\kappa=1\)</span>, we see the following result:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb14-1"><a href="Moment.html#cb14-1" tabindex="-1"></a><span class="va">ITE</span> <span class="va">PFEAS</span>    <span class="va">DFEAS</span>    <span class="va">GFEAS</span>    <span class="va">PRSTATUS</span>   <span class="va">POBJ</span>              <span class="va">DOBJ</span>              <span class="va">MU</span>       <span class="va">TIME</span>  </span>
<span id="cb14-2"><a href="Moment.html#cb14-2" tabindex="-1"></a><span class="fl">0</span>   <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">0.00e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">1.0e+00</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-3"><a href="Moment.html#cb14-3" tabindex="-1"></a><span class="fl">1</span>   <span class="fl">1.8e-01</span>  <span class="fl">1.8e-01</span>  <span class="fl">1.4e-01</span>  <span class="fl">3.28e-01</span>   <span class="fl">2.041575331e-01</span>   <span class="fl">5.267481899e-01</span>   <span class="fl">1.8e-01</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-4"><a href="Moment.html#cb14-4" tabindex="-1"></a><span class="fl">2</span>   <span class="fl">3.5e-02</span>  <span class="fl">3.5e-02</span>  <span class="fl">1.4e-02</span>  <span class="fl">9.46e-01</span>   <span class="fl">4.043057656e-01</span>   <span class="fl">4.966964156e-01</span>   <span class="fl">3.5e-02</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-5"><a href="Moment.html#cb14-5" tabindex="-1"></a><span class="fl">3</span>   <span class="fl">1.3e-02</span>  <span class="fl">1.3e-02</span>  <span class="fl">3.8e-03</span>  <span class="fl">5.26e-01</span>   <span class="fl">2.214064092e-01</span>   <span class="fl">2.805094594e-01</span>   <span class="fl">1.3e-02</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-6"><a href="Moment.html#cb14-6" tabindex="-1"></a><span class="fl">4</span>   <span class="fl">3.5e-03</span>  <span class="fl">3.5e-03</span>  <span class="fl">6.1e-04</span>  <span class="fl">7.62e-01</span>   <span class="fl">1.925510959e-01</span>   <span class="fl">2.134013995e-01</span>   <span class="fl">3.5e-03</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-7"><a href="Moment.html#cb14-7" tabindex="-1"></a><span class="fl">5</span>   <span class="fl">1.1e-03</span>  <span class="fl">1.1e-03</span>  <span class="fl">1.7e-04</span>  <span class="fl">4.01e-01</span>   <span class="fl">1.154109271e-01</span>   <span class="fl">1.350598297e-01</span>   <span class="fl">1.1e-03</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-8"><a href="Moment.html#cb14-8" tabindex="-1"></a><span class="fl">6</span>   <span class="fl">2.9e-04</span>  <span class="fl">2.9e-04</span>  <span class="fl">2.8e-05</span>  <span class="fl">7.10e-01</span>   <span class="fl">8.188641629e-02</span>   <span class="fl">8.975466685e-02</span>   <span class="fl">2.9e-04</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-9"><a href="Moment.html#cb14-9" tabindex="-1"></a><span class="fl">7</span>   <span class="fl">9.1e-05</span>  <span class="fl">9.1e-05</span>  <span class="fl">8.2e-06</span>  <span class="fl">4.07e-01</span>   <span class="fl">5.245561798e-02</span>   <span class="fl">5.978149022e-02</span>   <span class="fl">9.1e-05</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-10"><a href="Moment.html#cb14-10" tabindex="-1"></a><span class="fl">8</span>   <span class="fl">2.7e-05</span>  <span class="fl">2.7e-05</span>  <span class="fl">1.6e-06</span>  <span class="fl">6.84e-01</span>   <span class="fl">3.727529406e-02</span>   <span class="fl">4.054196962e-02</span>   <span class="fl">2.7e-05</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-11"><a href="Moment.html#cb14-11" tabindex="-1"></a><span class="fl">9</span>   <span class="fl">9.9e-06</span>  <span class="fl">9.9e-06</span>  <span class="fl">6.1e-07</span>  <span class="fl">3.09e-01</span>   <span class="fl">2.492316391e-02</span>   <span class="fl">2.855972552e-02</span>   <span class="fl">9.9e-06</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-12"><a href="Moment.html#cb14-12" tabindex="-1"></a><span class="fl">10</span>  <span class="fl">2.5e-06</span>  <span class="fl">2.5e-06</span>  <span class="fl">9.4e-08</span>  <span class="fl">6.93e-01</span>   <span class="fl">1.662754698e-02</span>   <span class="fl">1.801019802e-02</span>   <span class="fl">2.5e-06</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-13"><a href="Moment.html#cb14-13" tabindex="-1"></a><span class="fl">11</span>  <span class="fl">7.4e-07</span>  <span class="fl">7.4e-07</span>  <span class="fl">2.7e-08</span>  <span class="fl">3.57e-01</span>   <span class="fl">1.066174340e-02</span>   <span class="fl">1.199307778e-02</span>   <span class="fl">7.4e-07</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-14"><a href="Moment.html#cb14-14" tabindex="-1"></a><span class="fl">12</span>  <span class="fl">2.2e-07</span>  <span class="fl">2.2e-07</span>  <span class="fl">5.4e-09</span>  <span class="fl">6.43e-01</span>   <span class="fl">7.435651393e-03</span>   <span class="fl">8.053182585e-03</span>   <span class="fl">2.2e-07</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-15"><a href="Moment.html#cb14-15" tabindex="-1"></a><span class="fl">13</span>  <span class="fl">7.8e-08</span>  <span class="fl">7.8e-08</span>  <span class="fl">2.1e-09</span>  <span class="fl">2.63e-01</span>   <span class="fl">5.027346675e-03</span>   <span class="fl">5.735405751e-03</span>   <span class="fl">7.8e-08</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-16"><a href="Moment.html#cb14-16" tabindex="-1"></a><span class="fl">14</span>  <span class="fl">1.9e-08</span>  <span class="fl">1.9e-08</span>  <span class="fl">3.1e-10</span>  <span class="fl">6.78e-01</span>   <span class="fl">3.274376941e-03</span>   <span class="fl">3.539771530e-03</span>   <span class="fl">1.9e-08</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-17"><a href="Moment.html#cb14-17" tabindex="-1"></a><span class="fl">15</span>  <span class="fl">5.4e-09</span>  <span class="fl">5.4e-09</span>  <span class="fl">8.6e-11</span>  <span class="fl">3.51e-01</span>   <span class="fl">2.090217524e-03</span>   <span class="fl">2.340150880e-03</span>   <span class="fl">5.4e-09</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-18"><a href="Moment.html#cb14-18" tabindex="-1"></a><span class="fl">16</span>  <span class="fl">1.6e-09</span>  <span class="fl">1.6e-09</span>  <span class="fl">1.8e-11</span>  <span class="fl">6.25e-01</span>   <span class="fl">1.460073639e-03</span>   <span class="fl">1.580348192e-03</span>   <span class="fl">1.6e-09</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-19"><a href="Moment.html#cb14-19" tabindex="-1"></a><span class="fl">17</span>  <span class="fl">6.0e-10</span>  <span class="fl">6.0e-10</span>  <span class="fl">7.2e-12</span>  <span class="fl">2.35e-01</span>   <span class="fl">1.000023643e-03</span>   <span class="fl">1.142129878e-03</span>   <span class="fl">6.0e-10</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-20"><a href="Moment.html#cb14-20" tabindex="-1"></a><span class="fl">18</span>  <span class="fl">1.4e-10</span>  <span class="fl">1.4e-10</span>  <span class="fl">1.0e-12</span>  <span class="fl">6.79e-01</span>   <span class="fl">6.400941650e-04</span>   <span class="fl">6.913204662e-04</span>   <span class="fl">1.4e-10</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-21"><a href="Moment.html#cb14-21" tabindex="-1"></a><span class="fl">19</span>  <span class="fl">1.0e-10</span>  <span class="fl">3.9e-11</span>  <span class="fl">2.7e-13</span>  <span class="fl">3.56e-01</span>   <span class="fl">4.051653495e-04</span>   <span class="fl">4.517858240e-04</span>   <span class="fl">3.9e-11</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-22"><a href="Moment.html#cb14-22" tabindex="-1"></a><span class="fl">20</span>  <span class="fl">1.2e-11</span>  <span class="fl">1.2e-11</span>  <span class="fl">5.8e-14</span>  <span class="fl">6.05e-01</span>   <span class="fl">2.840240254e-04</span>   <span class="fl">3.074642454e-04</span>   <span class="fl">1.2e-11</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-23"><a href="Moment.html#cb14-23" tabindex="-1"></a><span class="fl">21</span>  <span class="fl">4.6e-12</span>  <span class="fl">4.5e-12</span>  <span class="fl">2.4e-14</span>  <span class="fl">2.10e-01</span>   <span class="fl">1.967647207e-04</span>   <span class="fl">2.251266137e-04</span>   <span class="fl">4.5e-12</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-24"><a href="Moment.html#cb14-24" tabindex="-1"></a><span class="fl">22</span>  <span class="fl">1.0e-12</span>  <span class="fl">1.0e-12</span>  <span class="fl">3.3e-15</span>  <span class="fl">6.81e-01</span>   <span class="fl">1.242068557e-04</span>   <span class="fl">1.340389165e-04</span>   <span class="fl">1.0e-12</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-25"><a href="Moment.html#cb14-25" tabindex="-1"></a><span class="fl">23</span>  <span class="fl">2.7e-13</span>  <span class="fl">2.7e-13</span>  <span class="fl">8.0e-16</span>  <span class="fl">3.56e-01</span>   <span class="fl">7.772043572e-05</span>   <span class="fl">8.646338802e-05</span>   <span class="fl">2.7e-13</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-26"><a href="Moment.html#cb14-26" tabindex="-1"></a><span class="fl">24</span>  <span class="fl">8.5e-14</span>  <span class="fl">8.5e-14</span>  <span class="fl">1.8e-16</span>  <span class="fl">5.92e-01</span>   <span class="fl">5.463905229e-05</span>   <span class="fl">5.916694930e-05</span>   <span class="fl">8.5e-14</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-27"><a href="Moment.html#cb14-27" tabindex="-1"></a><span class="fl">25</span>  <span class="fl">3.3e-14</span>  <span class="fl">3.3e-14</span>  <span class="fl">7.7e-17</span>  <span class="fl">1.91e-01</span>   <span class="fl">3.813146090e-05</span>   <span class="fl">4.367749095e-05</span>   <span class="fl">3.3e-14</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-28"><a href="Moment.html#cb14-28" tabindex="-1"></a><span class="fl">26</span>  <span class="fl">7.5e-15</span>  <span class="fl">7.5e-15</span>  <span class="fl">1.0e-17</span>  <span class="fl">6.82e-01</span>   <span class="fl">2.388667090e-05</span>   <span class="fl">2.575875793e-05</span>   <span class="fl">7.5e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-29"><a href="Moment.html#cb14-29" tabindex="-1"></a><span class="fl">27</span>  <span class="fl">9.5e-13</span>  <span class="fl">6.1e-15</span>  <span class="fl">8.2e-18</span>  <span class="fl">3.63e-01</span>   <span class="fl">2.249020870e-05</span>   <span class="fl">2.430458202e-05</span>   <span class="fl">6.1e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-30"><a href="Moment.html#cb14-30" tabindex="-1"></a><span class="fl">28</span>  <span class="fl">2.7e-13</span>  <span class="fl">1.3e-15</span>  <span class="fl">1.5e-18</span>  <span class="fl">3.14e-01</span>   <span class="fl">1.318081011e-05</span>   <span class="fl">1.456985641e-05</span>   <span class="fl">1.3e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-31"><a href="Moment.html#cb14-31" tabindex="-1"></a><span class="fl">29</span>  <span class="fl">7.4e-13</span>  <span class="fl">1.2e-15</span>  <span class="fl">1.4e-18</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.295450582e-05</span>   <span class="fl">1.429001140e-05</span>   <span class="fl">1.2e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-32"><a href="Moment.html#cb14-32" tabindex="-1"></a><span class="fl">30</span>  <span class="fl">9.7e-13</span>  <span class="fl">1.2e-15</span>  <span class="fl">1.4e-18</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.283897715e-05</span>   <span class="fl">1.414828202e-05</span>   <span class="fl">1.2e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-33"><a href="Moment.html#cb14-33" tabindex="-1"></a><span class="fl">31</span>  <span class="fl">1.0e-12</span>  <span class="fl">1.2e-15</span>  <span class="fl">1.4e-18</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.280983848e-05</span>   <span class="fl">1.411266897e-05</span>   <span class="fl">1.2e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-34"><a href="Moment.html#cb14-34" tabindex="-1"></a><span class="fl">32</span>  <span class="fl">1.0e-12</span>  <span class="fl">1.2e-15</span>  <span class="fl">1.4e-18</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.280618882e-05</span>   <span class="fl">1.410821245e-05</span>   <span class="fl">1.2e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-35"><a href="Moment.html#cb14-35" tabindex="-1"></a><span class="fl">33</span>  <span class="fl">1.0e-12</span>  <span class="fl">1.2e-15</span>  <span class="fl">1.4e-18</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.280436352e-05</span>   <span class="fl">1.410598387e-05</span>   <span class="fl">1.2e-15</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-36"><a href="Moment.html#cb14-36" tabindex="-1"></a><span class="fl">34</span>  <span class="fl">7.1e-13</span>  <span class="fl">3.3e-16</span>  <span class="fl">2.8e-19</span>  <span class="fl">4.71e-01</span>   <span class="fl">8.481144013e-06</span>   <span class="fl">9.212971618e-06</span>   <span class="fl">3.3e-16</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-37"><a href="Moment.html#cb14-37" tabindex="-1"></a><span class="fl">35</span>  <span class="fl">7.2e-13</span>  <span class="fl">3.3e-16</span>  <span class="fl">2.8e-19</span>  <span class="fl">1.00e+00</span>   <span class="fl">8.474714028e-06</span>   <span class="fl">9.205554497e-06</span>   <span class="fl">3.3e-16</span>  <span class="fl">0.00</span>  </span>
<span id="cb14-38"><a href="Moment.html#cb14-38" tabindex="-1"></a><span class="fl">36</span>  <span class="fl">7.3e-13</span>  <span class="fl">3.3e-16</span>  <span class="fl">2.8e-19</span>  <span class="fl">1.00e+00</span>   <span class="fl">8.473094330e-06</span>   <span class="fl">9.203686456e-06</span>   <span class="fl">3.3e-16</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-39"><a href="Moment.html#cb14-39" tabindex="-1"></a><span class="fl">37</span>  <span class="fl">4.4e-14</span>  <span class="fl">1.2e-16</span>  <span class="fl">1.1e-19</span>  <span class="fl">1.73e-01</span>   <span class="fl">5.812012110e-06</span>   <span class="fl">6.610489568e-06</span>   <span class="fl">1.2e-16</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-40"><a href="Moment.html#cb14-40" tabindex="-1"></a><span class="fl">38</span>  <span class="fl">3.2e-13</span>  <span class="fl">7.8e-17</span>  <span class="fl">5.6e-20</span>  <span class="fl">1.00e+00</span>   <span class="fl">4.907525789e-06</span>   <span class="fl">5.428890141e-06</span>   <span class="fl">8.3e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-41"><a href="Moment.html#cb14-41" tabindex="-1"></a><span class="fl">39</span>  <span class="fl">3.9e-13</span>  <span class="fl">7.1e-17</span>  <span class="fl">4.9e-20</span>  <span class="fl">1.00e+00</span>   <span class="fl">4.737143451e-06</span>   <span class="fl">5.216312950e-06</span>   <span class="fl">7.7e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-42"><a href="Moment.html#cb14-42" tabindex="-1"></a><span class="fl">40</span>  <span class="fl">1.0e-13</span>  <span class="fl">1.9e-17</span>  <span class="fl">9.0e-21</span>  <span class="fl">5.68e-01</span>   <span class="fl">3.163202225e-06</span>   <span class="fl">3.391803637e-06</span>   <span class="fl">2.0e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-43"><a href="Moment.html#cb14-43" tabindex="-1"></a><span class="fl">41</span>  <span class="fl">2.1e-13</span>  <span class="fl">1.8e-17</span>  <span class="fl">8.3e-21</span>  <span class="fl">1.00e+00</span>   <span class="fl">3.079800819e-06</span>   <span class="fl">3.297015112e-06</span>   <span class="fl">2.0e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-44"><a href="Moment.html#cb14-44" tabindex="-1"></a><span class="fl">42</span>  <span class="fl">3.0e-13</span>  <span class="fl">1.7e-17</span>  <span class="fl">7.7e-21</span>  <span class="fl">1.00e+00</span>   <span class="fl">2.985096669e-06</span>   <span class="fl">3.190159883e-06</span>   <span class="fl">2.0e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-45"><a href="Moment.html#cb14-45" tabindex="-1"></a><span class="fl">43</span>  <span class="fl">3.1e-13</span>  <span class="fl">1.7e-17</span>  <span class="fl">7.6e-21</span>  <span class="fl">1.00e+00</span>   <span class="fl">2.972167540e-06</span>   <span class="fl">3.175652455e-06</span>   <span class="fl">2.0e-17</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-46"><a href="Moment.html#cb14-46" tabindex="-1"></a><span class="fl">44</span>  <span class="fl">1.2e-13</span>  <span class="fl">3.9e-18</span>  <span class="fl">1.6e-21</span>  <span class="fl">1.93e-01</span>   <span class="fl">1.802355527e-06</span>   <span class="fl">1.972166368e-06</span>   <span class="fl">4.4e-18</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-47"><a href="Moment.html#cb14-47" tabindex="-1"></a><span class="fl">45</span>  <span class="fl">1.7e-13</span>  <span class="fl">1.5e-18</span>  <span class="fl">3.7e-22</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.272549881e-06</span>   <span class="fl">1.334918948e-06</span>   <span class="fl">1.7e-18</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-48"><a href="Moment.html#cb14-48" tabindex="-1"></a><span class="fl">46</span>  <span class="fl">1.7e-13</span>  <span class="fl">1.5e-18</span>  <span class="fl">3.7e-22</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.272549881e-06</span>   <span class="fl">1.334918948e-06</span>   <span class="fl">1.7e-18</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-49"><a href="Moment.html#cb14-49" tabindex="-1"></a><span class="fl">47</span>  <span class="fl">1.7e-13</span>  <span class="fl">1.5e-18</span>  <span class="fl">3.7e-22</span>  <span class="fl">1.00e+00</span>   <span class="fl">1.272549881e-06</span>   <span class="fl">1.334918948e-06</span>   <span class="fl">1.7e-18</span>  <span class="fl">0.01</span>  </span>
<span id="cb14-50"><a href="Moment.html#cb14-50" tabindex="-1"></a><span class="va">Optimizer</span> <span class="va">terminated</span>. <span class="va">Time</span><span class="op">:</span> <span class="fl">0.01</span>    </span>
<span id="cb14-51"><a href="Moment.html#cb14-51" tabindex="-1"></a></span>
<span id="cb14-52"><a href="Moment.html#cb14-52" tabindex="-1"></a></span>
<span id="cb14-53"><a href="Moment.html#cb14-53" tabindex="-1"></a><span class="va">Interior</span><span class="op">-</span><span class="va">point</span> <span class="va">solution</span> <span class="va">summary</span></span>
<span id="cb14-54"><a href="Moment.html#cb14-54" tabindex="-1"></a>  <span class="va">Problem</span> <span class="va">status</span>  <span class="op">:</span> <span class="va">PRIMAL_AND_DUAL_FEASIBLE</span></span>
<span id="cb14-55"><a href="Moment.html#cb14-55" tabindex="-1"></a>  <span class="va">Solution</span> <span class="va">status</span> <span class="op">:</span> <span class="va">OPTIMAL</span></span></code></pre></div>
<p>which shows the solver converged and the optimal value is numerically close to zero. This shows the correctness of the last point in the Theorem above.</p>
<p>We can also write the constraint <span class="math inline">\(x_2^2 \leq 0\)</span> equivalently as <span class="math inline">\(x_2 = 0\)</span>, in which case the POP will satisfy the first point of Theorem <a href="Moment.html#thm:MomentSOSHierarchy">5.6</a> and strong duality holds. Implementing this in code, MOSEK produces the following outut</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb15-1"><a href="Moment.html#cb15-1" tabindex="-1"></a><span class="va">ITE</span> <span class="va">PFEAS</span>    <span class="va">DFEAS</span>    <span class="va">GFEAS</span>    <span class="va">PRSTATUS</span>   <span class="va">POBJ</span>              <span class="va">DOBJ</span>              <span class="va">MU</span>       <span class="va">TIME</span>  </span>
<span id="cb15-2"><a href="Moment.html#cb15-2" tabindex="-1"></a><span class="fl">0</span>   <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">1.0e+00</span>  <span class="fl">0.00e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">0.000000000e+00</span>   <span class="fl">1.0e+00</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-3"><a href="Moment.html#cb15-3" tabindex="-1"></a><span class="fl">1</span>   <span class="fl">2.8e-01</span>  <span class="fl">2.8e-01</span>  <span class="fl">1.7e-01</span>  <span class="fl">6.80e-01</span>   <span class="fl">1.784287181e-01</span>   <span class="fl">2.250737385e-01</span>   <span class="fl">2.8e-01</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-4"><a href="Moment.html#cb15-4" tabindex="-1"></a><span class="fl">2</span>   <span class="fl">1.6e-02</span>  <span class="fl">1.6e-02</span>  <span class="fl">2.4e-03</span>  <span class="fl">1.10e+00</span>   <span class="op">-</span><span class="fl">1.896781377e-02</span>  <span class="op">-</span><span class="fl">1.421782353e-02</span>  <span class="fl">1.6e-02</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-5"><a href="Moment.html#cb15-5" tabindex="-1"></a><span class="fl">3</span>   <span class="fl">1.8e-04</span>  <span class="fl">1.8e-04</span>  <span class="fl">2.7e-06</span>  <span class="fl">1.00e+00</span>   <span class="op">-</span><span class="fl">2.173561193e-04</span>  <span class="op">-</span><span class="fl">1.728424914e-04</span>  <span class="fl">1.8e-04</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-6"><a href="Moment.html#cb15-6" tabindex="-1"></a><span class="fl">4</span>   <span class="fl">1.0e-06</span>  <span class="fl">1.0e-06</span>  <span class="fl">1.2e-09</span>  <span class="fl">1.00e+00</span>   <span class="op">-</span><span class="fl">1.291256020e-06</span>  <span class="op">-</span><span class="fl">1.041546182e-06</span>  <span class="fl">1.0e-06</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-7"><a href="Moment.html#cb15-7" tabindex="-1"></a><span class="fl">5</span>   <span class="fl">1.9e-08</span>  <span class="fl">1.9e-08</span>  <span class="fl">3.0e-12</span>  <span class="fl">1.00e+00</span>   <span class="op">-</span><span class="fl">2.316455946e-08</span>  <span class="op">-</span><span class="fl">1.858439993e-08</span>  <span class="fl">1.9e-08</span>  <span class="fl">0.00</span>  </span>
<span id="cb15-8"><a href="Moment.html#cb15-8" tabindex="-1"></a><span class="va">Optimizer</span> <span class="va">terminated</span>. <span class="va">Time</span><span class="op">:</span> <span class="fl">0.00</span>    </span>
<span id="cb15-9"><a href="Moment.html#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="Moment.html#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="Moment.html#cb15-11" tabindex="-1"></a><span class="va">Interior</span><span class="op">-</span><span class="va">point</span> <span class="va">solution</span> <span class="va">summary</span></span>
<span id="cb15-12"><a href="Moment.html#cb15-12" tabindex="-1"></a>  <span class="va">Problem</span> <span class="va">status</span>  <span class="op">:</span> <span class="va">PRIMAL_AND_DUAL_FEASIBLE</span></span>
<span id="cb15-13"><a href="Moment.html#cb15-13" tabindex="-1"></a>  <span class="va">Solution</span> <span class="va">status</span> <span class="op">:</span> <span class="va">OPTIMAL</span></span></code></pre></div>
<p>with optimal value numerically zero.</p>
<p>In all three cases, the geometry of the feasible set never changes, what changed was the algebraic description of the same geometric set. This shows that the moment-SOS hierarchy can be sensitive to how the user describes the problem.</p>
</div>
</div>
</div>
<div id="measure-theoretic-interpretation" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Measure-Theoretic Interpretation<a href="Moment.html#measure-theoretic-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us zoom out a bit and see what we have done. We started with Putinar’s Positivstellensatz, applied it to polynomial optimization (POP) and obtained the SOS relaxation of POPs. Then, by taking the dual of <span class="math inline">\(\mathbb{R}[x]_{2d}\)</span> and <span class="math inline">\(\mathrm{Ideal}[h] + \mathrm{Qmodule}[g]\)</span>, and applying standard conic duality, we obtained the primal moment relaxation, which is an optimization over the truncated multi-sequence <span class="math inline">\(y\)</span>.</p>
<p>However, recall in the discussion of Shor’s SDP relaxation, the dual of the dual can be directly obtained by first writing the QCQP as a rank-constrained matrix optimization problem and then dropping the rank constraint – an approach that gives us the primal relaxation without needing to go through the dual relaxation. Can we do the same for POPs, i.e., obtaining the moment relaxation without needing to go through the SOS relaxation? The answer is affirmative.</p>
<p>Consider the polynomial optimization (POP) in <a href="Moment.html#eq:pop-restate">(5.12)</a> and denote its feasible set as
<span class="math display">\[
S = \{ x \in \mathbb{R}^{n} \mid h_i(x)=0,i=1,\dots,l_h, g_i(x)\geq 0, i=1,\dots,l_g \}.
\]</span>
We assume <span class="math inline">\(S\)</span> is compact and Archimedean (e.g., there is a ball constraint <span class="math inline">\(R - x^\top x \geq 0\)</span> in <span class="math inline">\(g\)</span>). The POP <a href="Moment.html#eq:pop-restate">(5.12)</a> is equivalent to
<span class="math display" id="eq:pop-with-S">\[\begin{equation}
p^\star = \min_{x \in S} \quad p(x).
\tag{5.17}
\end{equation}\]</span></p>
<p>A key observation is that problem <a href="Moment.html#eq:pop-with-S">(5.17)</a> is equivalent to an <strong>infinite-dimensional convex optimization problem</strong>! Let <span class="math inline">\(\mathcal{P}(S)\)</span> be the space of all possible measures supported on <span class="math inline">\(S\)</span>, the following result shows that the POP <a href="Moment.html#eq:pop-with-S">(5.17)</a> is equivalent to a linear optimization over <span class="math inline">\(\mathcal{P}(S)\)</span>.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:MeasureOpt" class="theorem"><strong>Theorem 5.7  (Optimization over Measures) </strong></span>The following optimization
<span class="math display" id="eq:measure-opt">\[\begin{equation}
\begin{split}
\rho^\star = \min_{ \mu \in \mathcal{P}(S)} &amp; \quad \int_S p(x) d \mu(x) \\
\mathrm{s.t.}&amp; \quad \int_S 1 d \mu(x) = 1.
\end{split}
\tag{5.18}
\end{equation}\]</span>
is equivalent to the POP <a href="Moment.html#eq:pop-with-S">(5.17)</a>, i.e., <span class="math inline">\(p^\star = \rho^\star\)</span>.</p>
</div>
</div>
<div class="proofbox">
<div class="proof">
<p><span id="unlabeled-div-18" class="proof"><em>Proof</em>. </span>To see this, note that if <span class="math inline">\(p^\star = -\infty\)</span>, then trivially <span class="math inline">\(\rho^\star = -\infty\)</span> (this is left as an exercise for you). We focus on the case <span class="math inline">\(p^\star &gt; - \infty\)</span> is finite. Since <span class="math inline">\(p^\star\)</span> is the global minimum, we have
<span class="math display">\[
p(x) \geq p^\star, \forall x \in S.
\]</span>
Therefore,
<span class="math display">\[
\int_S p(x) d\mu(x) \geq \int_S p^\star d \mu(x) \geq p^\star, \quad \forall \mu \in \mathcal{P}(S), \int_S 1 d\mu(x) = 1.
\]</span>
This shows that
<span class="math display">\[
\rho^\star \geq p^\star.
\]</span>
Conversely, for any <span class="math inline">\(x \in S\)</span>, let <span class="math inline">\(\delta_{x}\)</span> be the Dirac measure. We have <span class="math inline">\(\delta_{x}\)</span> is feasible for problem <a href="Moment.html#eq:measure-opt">(5.18)</a> and attains the same cost as <span class="math inline">\(x\)</span> for the POP. This shows that
<span class="math display">\[
\rho^\star \leq p^\star.
\]</span>
As a result, <span class="math inline">\(\rho^\star = p^\star\)</span>.</p>
</div>
</div>
<p>The proof shows that, if <span class="math inline">\(x_\star\)</span> is a global optimizer of the POP, then the Dirac measure <span class="math inline">\(\mu_\star = \delta_{x_\star}\)</span> is an optimal solution to <a href="Moment.html#eq:measure-opt">(5.18)</a>.</p>
<p>Now let us inspect the objective function of <a href="Moment.html#eq:measure-opt">(5.18)</a>. Suppose <span class="math inline">\(p(x) \in \mathbb{R}[x]_{2d}\)</span>, then
<span class="math display">\[
p(x) = \sum_{\alpha \in \mathcal{F}_{n,2d}} p_{\alpha} x^{\alpha} = \langle \mathrm{vec}(p), [x]_{2d} \rangle.
\]</span>
Plugging this to the objective function, we see
<span class="math display">\[
\int_S p(x) d \mu(x) = \int_S \left(\sum_{\alpha} p_{\alpha} x^{\alpha}\right) d \mu(x) = \sum_{\alpha} p_{\alpha} \left(\int_S x^{\alpha} d \mu(x)\right).
\]</span>
Denoting
<span class="math display">\[
y_{\alpha} = \int_S x^{\alpha} d \mu(x),
\]</span>
as the <span class="math inline">\(\alpha\)</span> moment of <span class="math inline">\(\mu\)</span> on <span class="math inline">\(S\)</span>, and
<span class="math display" id="eq:representing-measure">\[\begin{equation}
y = (y_\alpha)_{\alpha \in \mathcal{F}_{n,2d}} = \int_S [x]_{2d} d \mu(x)
\tag{5.19}
\end{equation}\]</span>
as the truncated moment sequence of degree up to <span class="math inline">\(2d\)</span>, we can see that problem <a href="Moment.html#eq:measure-opt">(5.18)</a> is a linear optimization over the moments of <span class="math inline">\(\mu\)</span>:
<span class="math display" id="eq:measure-opt-moments">\[\begin{equation}
\begin{split}
\min_{\mu \in \mathcal{P}(S)} &amp; \quad \langle \mathrm{vec}(p), y \rangle \\
\mathrm{s.t.}&amp; \quad y_0 = 1
\end{split}
\tag{5.20}
\end{equation}\]</span>
where <span class="math inline">\(y_0\)</span> is the zero-order moment.</p>
<p>Now in order to solve problem <a href="Moment.html#eq:measure-opt-moments">(5.20)</a>, the key question boils down to: given a TMS <span class="math inline">\(y = (y_{\alpha})\)</span>, under what conditions can we ensure that <span class="math inline">\(y\)</span> has a <strong>representing measure</strong> supported on <span class="math inline">\(S\)</span>, i.e., equation <a href="Moment.html#eq:representing-measure">(5.19)</a> holds for some measure <span class="math inline">\(\mu\)</span>?</p>
<p>As we will introduce soon, we will derive <strong>necessary conditions</strong> on the TMS <span class="math inline">\(y\)</span> for it to admit a representing measure, which surprisingly and not surprisingly, is exactly the dual conic constraint <span class="math inline">\(y \in \mathcal{Z}[h]_{2d} \cap \mathcal{M}[g]_{2d}\)</span> we introduced in Theorem <a href="Moment.html#thm:DualSumIdealQuadraticModule">5.5</a>! Therefore, the moment relaxation can be derived by solving <a href="Moment.html#eq:measure-opt-moments">(5.20)</a> with necessary conditions on <span class="math inline">\(y\)</span> admitting a representing measure.</p>
<p>However, the measure-theoretic perspective will give us one advantage, i.e., via checkable <strong>sufficient conditions</strong> for <span class="math inline">\(y\)</span> to admit a representing measure, we can <strong>certify</strong> convergence of the moment-SOS hierarchy and extract global minimizers of the original POP!</p>
</div>
<div id="truncated-moment-problem" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Truncated Moment Problem<a href="Moment.html#truncated-moment-problem" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Given a truncated multi-sequence <span class="math inline">\(y = (y_\alpha)_{\alpha \in \mathcal{F}_{n,2d}}\)</span>, it is said to admit a Borel measure if <a href="Moment.html#eq:representing-measure">(5.19)</a> holds for some measure <span class="math inline">\(\mu\)</span> supported on <span class="math inline">\(S\)</span> (the support of a measure on <span class="math inline">\(\mathbb{R}^{n}\)</span> is the smallest closed set <span class="math inline">\(T \subseteq \mathbb{R}^{n}\)</span> such that <span class="math inline">\(\mu(\mathbb{R}^{n} \backslash T) = 0\)</span>), in which case <span class="math inline">\(\mu\)</span> is called a <strong><span class="math inline">\(S\)</span>-representing measure</strong> of <span class="math inline">\(y\)</span>.</p>
<p>A measure <span class="math inline">\(\mu\)</span> whose support is a finite set is called <strong>finitely atomic</strong>. A measure is called <span class="math inline">\(r\)</span>-atomic if its support has cardinality <span class="math inline">\(r\)</span>.</p>
<p>The following result, due to <span class="citation">(<a href="#ref-bayer06ams-proof">Bayer and Teichmann 2006</a>)</span>, shows that a representing measure can always be chosen to be finitely atomic if it exists.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:RepresentingMeasure" class="theorem"><strong>Theorem 5.8  (Representing Measure) </strong></span>If a TMS <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> admits a representing measure, then it also admits a
finitely atomic representing measure <span class="math inline">\(\nu\)</span> such that
<span class="math display">\[
\mathrm{supp}(\nu) \subseteq \mathrm{supp}(\mu), \quad \left\vert \mathrm{supp}(\nu) \right\vert \leq s(n,2d).
\]</span></p>
</div>
</div>
<p>The <strong>truncated <span class="math inline">\(S\)</span>-moment problem</strong> concerns the following: given a TMS <span class="math inline">\(y\)</span>, does it admit a representing measure <span class="math inline">\(\mu\)</span> supported on <span class="math inline">\(S\)</span>?</p>
<p>To answer this question, let us pick any polynomial <span class="math inline">\(p(x) \in \mathbb{R}[x]_{2d}\)</span> that is SOS, then it is easy to see that, for any measure <span class="math inline">\(\mu\)</span>,
<span class="math display">\[
\int_S p(x) d\mu(x) \geq 0
\]</span>
must hold. Using the fact that <span class="math inline">\(p(x)\)</span> is SOS, we can write
<span class="math display">\[
p(x) = [x]_d^\top Q [x]_d = \left\langle Q, [x]_d [x]_d^\top \right\rangle, \quad Q \succeq 0
\]</span>
and therefore
<span class="math display" id="eq:integral-to-moment-matrix">\[\begin{equation}
\int_S p(x) d\mu(x) = \int_S \left\langle Q, [x]_d [x]_d^\top \right\rangle d \mu(x) = \left\langle Q,  \int_S [x]_d [x]_d^\top d \mu(x)  \right\rangle = \langle Q, M_d[y] \rangle
\tag{5.21}
\end{equation}\]</span>
where <span class="math inline">\(M_d[y] \in \mathbb{S}^{s(n,d)}\)</span> is the moment matrix of <span class="math inline">\(\mu\)</span>’s truncated moment sequence <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span>. In order for <a href="Moment.html#eq:integral-to-moment-matrix">(5.21)</a> to be nonnegative for any <span class="math inline">\(Q \succeq 0\)</span>, the moment matrix <span class="math inline">\(M_d[y]\)</span> must be positive semidefinite.</p>
<p>We can keep doing this using the defining polynomials of <span class="math inline">\(S\)</span>. Pick any <span class="math inline">\(g_i(x) \geq 0\)</span> constraint that defines <span class="math inline">\(S\)</span>, and any SOS polynomial <span class="math inline">\(\sigma_i(x)\)</span> whose degree <span class="math inline">\(2s_i\)</span> is chosen such that <span class="math inline">\(2 s_i + \deg(g) \leq 2d\)</span>, then
<span class="math display">\[
\int_S g_i(x) \sigma_i(x) d\mu(x) \geq 0
\]</span>
must hold. Since <span class="math inline">\(\sigma_i(x)\)</span> is SOS, it can be written as <span class="math inline">\(\sigma_i(x) = [x]_{s_i}^\top Q_i [x]_{s_i}\)</span> for some <span class="math inline">\(Q_i \succeq 0\)</span>. Then we have
<span class="math display">\[
\int_S g_i(x) \sigma_i(x) d\mu(x) = \int_S g_i(x) [x]_{s_i}^\top Q_i [x]_{s_i} d\mu(x) = \left\langle Q_i,  \int_S g_i(x) [x]_{s_i}[x]_{s_i}^\top d\mu(x)  \right\rangle = \langle Q_i,  L_{g_i}^d[y] \rangle
\]</span>
where <span class="math inline">\(L_{g_i}^d [y]\)</span> is the localizing matrix of <span class="math inline">\(g_i(x)\)</span> generated by the moment vector <span class="math inline">\(y\)</span>. In order for the above equation to be nonnegative for any <span class="math inline">\(Q_i \succeq 0\)</span>, we must have <span class="math inline">\(L_{g_i}^d[y] \succeq 0\)</span> for any <span class="math inline">\(g_i\)</span>.</p>
<p>Similarly, we can pick any equality constraint <span class="math inline">\(h_i(x) = 0\)</span> that defines <span class="math inline">\(S\)</span> and any polynomial <span class="math inline">\(\lambda_i(x)\)</span> whose degree is chosen such that <span class="math inline">\(\deg(\lambda_i) + \deg(h_i) \leq 2d\)</span>, then
<span class="math display">\[
\int_S h_i(x) \lambda_i(x) d\mu(x) = 0.
\]</span>
In order for this equation to hold for any multiplier <span class="math inline">\(\lambda_i(x)\)</span>, one can verify that we must have the localizing vector <span class="math inline">\(L_{h_i}^{2d}[y] = 0\)</span>. This gives us a set of necessary conditions for <span class="math inline">\(y\)</span> to admit a representing measure.</p>
<div class="theorembox">
<div class="proposition">
<p><span id="prp:NecessaryConditionRepresentingMeasure" class="proposition"><strong>Proposition 5.1  (Necessary Condition for Existence of Representing Measure) </strong></span>Let <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> be a truncated multi-sequence. If <span class="math inline">\(y\)</span> admits an <span class="math inline">\(S\)</span>-representing measure, i.e., <a href="Moment.html#eq:representing-measure">(5.19)</a> holds for some measure <span class="math inline">\(\mu\)</span> supported on <span class="math inline">\(S\)</span>, then <span class="math inline">\(y\)</span> must satisfy
<span class="math display">\[
M_d[y] \succeq 0, \quad L_{g_i}^d[y] \succeq 0, i=1,\dots,l_g, \quad L_{h_i}^{2d}[y] = 0, i=1,\dots,l_h.
\]</span>
This is equivalent to <span class="math inline">\(y \in \mathcal{Z}[h]_{2d} \cap \mathcal{M}[g]_{2d}\)</span>.</p>
</div>
</div>
<p>The first corollary of Proposition <a href="Moment.html#prp:NecessaryConditionRepresentingMeasure">5.1</a> is that problem <a href="Moment.html#eq:moment-Putinar">(5.14)</a> is a convex relaxation for the infinite-dimensional problem <a href="Moment.html#eq:measure-opt">(5.18)</a>.</p>
<div class="theorembox">
<div class="corollary">
<p><span id="cor:MomentRelaxation" class="corollary"><strong>Corollary 5.1  (Moment Relaxation) </strong></span>The convex optimization problem <a href="Moment.html#eq:moment-Putinar">(5.14)</a> is a convex relaxation of problem <a href="Moment.html#eq:measure-opt">(5.18)</a> (and hence is also a relaxation of the original POP):
<span class="math display">\[
\beta^\star_\kappa \leq \rho^\star = p^\star.
\]</span></p>
</div>
</div>
<p>The second corollary of Proposition <a href="Moment.html#prp:NecessaryConditionRepresentingMeasure">5.1</a>, which is the extra advantage offered via this measure-theoretic interpretation, is that if we solve the moment relaxation <a href="Moment.html#eq:moment-Putinar">(5.14)</a> and obtain an optimal solution <span class="math inline">\(y_\star\)</span> that indeed admits a representing measure <span class="math inline">\(\mu_\star\)</span>, then <span class="math inline">\(\mu_\star\)</span> is in fact a global optimal solution to problem <a href="Moment.html#eq:measure-opt">(5.18)</a>. Moreover, if <span class="math inline">\(y_\star\)</span> admits a representing measure <span class="math inline">\(\mu_\star\)</span>, then by Theorem <a href="Moment.html#thm:RepresentingMeasure">5.8</a> it also admits a finitely atomic measure <span class="math inline">\(\nu_\star\)</span> and every point in the support of <span class="math inline">\(\nu_\star\)</span> is a global optimal solution to the POP. In this case, we say the moment-SOS relaxation is <strong>exact</strong> or <strong>tight</strong>.</p>
<div class="theorembox">
<div class="corollary">
<p><span id="cor:ExactnessOfRelaxation" class="corollary"><strong>Corollary 5.2  (Exactness of Moment Relaxation) </strong></span>Let the moment relaxation <a href="Moment.html#eq:moment-Putinar">(5.14)</a> be solvable and <span class="math inline">\(y_\star\)</span> be an optimal solution. If <span class="math inline">\(y_\star\)</span> admits an <span class="math inline">\(r\)</span>-atomic representing measure <span class="math inline">\(\nu_\star\)</span> supported on <span class="math inline">\(S\)</span>, then every point <span class="math inline">\(x_\star \in \mathrm{supp}(\nu_\star)\)</span> is a globally optimal solution to the POP <a href="Moment.html#eq:pop-with-S">(5.17)</a>.</p>
</div>
</div>
<div class="proofbox">
<div class="proof">
<p><span id="unlabeled-div-19" class="proof"><em>Proof</em>. </span>Since <span class="math inline">\(y_\star\)</span> admits an <span class="math inline">\(r\)</span>-atomic representing measure <span class="math inline">\(\nu_\star\)</span> we have
<span class="math display">\[
\nu_\star = \lambda_1 \delta_{u_1} + \dots + \lambda_r \delta_{u_r}, \quad \lambda_i \geq 0, i=1,\dots,r,
\]</span>
where <span class="math inline">\(\mathrm{supp}(\nu_\star) = \{ u_1,\dots,u_r \} \subset S\)</span>. This is equivalent to
<span class="math display">\[
y_\star = \lambda_1 [u_1]_{2\kappa} + \cdots + \lambda_r [u_r]_{2\kappa}, \quad \lambda_i \geq 0, i=1,\dots,r.
\]</span>
The fact that <span class="math inline">\(y_\star\)</span> needs to satisfy the constraint <span class="math inline">\(y_0 = 1\)</span> implies <span class="math inline">\(\sum_{i=1}^r \lambda_i = 1\)</span>.</p>
<p>By the nature of relaxation,
<span class="math display" id="eq:measure-proof-lower-bound">\[\begin{equation}
\langle \ell_{y_\star}, p(x) \rangle \leq p^\star \Rightarrow \sum_{i=1}^r \lambda_i p(u_i) \leq p^\star.
\tag{5.22}
\end{equation}\]</span>
However, since each <span class="math inline">\(u_i\)</span> is a feasible point to the POP, we have
<span class="math display" id="eq:measure-proof-upper-bound">\[\begin{equation}
p(u_i) \geq p^\star \Rightarrow \sum_{i=1}^r \lambda_i p(u_i) \geq p^\star.
\tag{5.23}
\end{equation}\]</span>
Combing <a href="Moment.html#eq:measure-proof-lower-bound">(5.22)</a> and <a href="Moment.html#eq:measure-proof-upper-bound">(5.23)</a>, we have
<span class="math display">\[
p(u_i) = p^\star, \quad \forall i=1,\dots,r,
\]</span>
and every <span class="math inline">\(u_i\)</span> is globally optimal for the POP.</p>
</div>
</div>
<p>This is an extremely powerful result. It shows that, if given a TMS <span class="math inline">\(y\)</span> one can check sufficient conditions on <span class="math inline">\(y\)</span> admitting an <span class="math inline">\(r\)</span>-atomic representing measure <span class="math inline">\(\nu_\star\)</span>, then it <strong>certifies convergence and exactness of the moment-SOS hierarchy</strong>. Moreover, every point in the support of <span class="math inline">\(\nu_\star\)</span> is a globally optimal solution of the original POP.</p>
</div>
<div id="flat-extension-detecting-global-optimality-and-extracting-solutions" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Flat Extension: Detecting Global Optimality and Extracting Solutions<a href="Moment.html#flat-extension-detecting-global-optimality-and-extracting-solutions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fortunately, there exist sufficient conditions for a TMS <span class="math inline">\(y \in \mathbb{R}^{s(n,2d)}\)</span> to admit an <span class="math inline">\(r\)</span>-atomic representing measure.
Suppose we solve the moment relaxation at order <span class="math inline">\(\kappa\)</span> and let <span class="math inline">\(y_\star = (y_\alpha)_{\alpha \in \mathcal{F}_{n,2\kappa}}\)</span> be an optimal solution. Denote
<span class="math display">\[
d_c := \max  \left\{ 1, \lceil \frac{\deg(h_i)}{2} \rceil,i=1,\dots,l_h, \lceil \frac{\deg(g_i)}{2} \rceil,i=1,\dots,l_g \right\}
\]</span>
and
<span class="math display">\[
d_0 := \max  \left\{ d_c, \lceil  \frac{\deg(f)}{2}  \rceil \right\} .
\]</span>
Clearly we have <span class="math inline">\(\kappa \geq d_0\)</span>, because otherwise the TMS <span class="math inline">\(y\)</span> does not have enough degree to include all monomials in the objective and constraint polynomials.</p>
<p>The following result gives a sufficient condition for the exactness of the moment-SOS relaxation.</p>
<div class="theorembox">
<div class="theorem">
<p><span id="thm:FlatTruncation" class="theorem"><strong>Theorem 5.9  (Flat Truncation) </strong></span>Suppose there exists <span class="math inline">\(t \in [d_0, \kappa]\)</span> such that
<span class="math display" id="eq:flat-extension">\[\begin{equation}
\mathrm{rank}(M_t[y_\star]) = \mathrm{rank}(M_{t-d_c}[y_\star]) = r,
\tag{5.24}
\end{equation}\]</span>
then the truncated optimal solution <span class="math inline">\(y_{\star,2t}:=(y_\alpha)_{\alpha \in \mathcal{F}_{n,2t}}\)</span> admits an <span class="math inline">\(r\)</span>-atomic representing measure <span class="math inline">\(\nu\)</span> such that each point in <span class="math inline">\(\mathrm{supp}(\nu)\)</span> is a global optimizer of the original POP.</p>
</div>
</div>
<p>Condition <a href="Moment.html#eq:flat-extension">(5.24)</a> is called <strong>flat extension</strong> for the truncated TMS <span class="math inline">\(y_{\star,2t}\)</span>. The proof that the flat extension condition is sufficient for an <span class="math inline">\(r\)</span>-atomic representing measure is due to <span class="citation">(<a href="#ref-curto05jot-truncated">Curto and Fialkow 2005</a>)</span>. The proof of exactness given an <span class="math inline">\(r\)</span>-atomic representing measure of <span class="math inline">\(y_{\star,2t}\)</span> is given by Corollary <a href="Moment.html#cor:ExactnessOfRelaxation">5.2</a>.</p>
<p>In the next, we will present an algorithm that can find the <span class="math inline">\(r\)</span>-atomic representing measure of <span class="math inline">\(y_{\star,2t}\)</span> when it satisfies the flat extension condition <a href="Moment.html#eq:flat-extension">(5.24)</a>, which was first proposed in <span class="citation">(<a href="#ref-henrion05ppc-detecting">Henrion and Lasserre 2005</a>)</span>. For ease of notation, I will remove the “<span class="math inline">\(\star\)</span>” subscript in the TMS <span class="math inline">\(y_{\star,2t}\)</span>. Given <span class="math inline">\(y \in \mathbb{R}^{s(n,2t)}\)</span>, the goal is to extract <span class="math inline">\(r = \mathrm{rank}(M_t[y])\)</span> optimal solutions of the POP.</p>
<p>Since <span class="math inline">\(y\)</span> admits an <span class="math inline">\(r\)</span>-atomic representing measure <span class="math inline">\(\nu\)</span>, we have
<span class="math display">\[
\nu = \lambda_1 \delta_{x_1} + \dots + \lambda_r \delta_{x_r}, \quad \lambda_i \geq 0, x_i \in S, i=1,\dots,r.
\]</span>
This implies
<span class="math display">\[\begin{equation}
\begin{split}
M_t[y] &amp; = \lambda_1 [x_1]_t [x_1]_t^\top+ \dots + \lambda_r [x_r]_t [x_r]_t^\top\\
&amp; = \underbrace{\begin{pmatrix} [x_1]_t &amp; \dots &amp; [x_r]_t \end{pmatrix}}_{:= V_\star \in \mathbb{R}^{s(n,t) \times r}}
\underbrace{\begin{pmatrix} \lambda_1 &amp;  &amp;  \\
&amp; \ddots &amp; \\
&amp;  &amp; \lambda_r \end{pmatrix}}_{\in \mathbb{R}^{r \times r}}
\underbrace{\begin{pmatrix}
[x_1]_t^\top\\
\vdots \\
[x_r]_t^\top
\end{pmatrix}}_{:= V_\star^\top\in \mathbb{R}^{r \times s(n,t)}}
\end{split}
\end{equation}\]</span></p>
<p>A polynomial <span class="math inline">\(p \in \mathbb{R}[x]_t\)</span> such that <span class="math inline">\(p \equiv 0\)</span> on <span class="math inline">\(\mathrm{supp}(\nu)\)</span> if and only if <span class="math inline">\(M_t[y] \mathrm{vec}(p) = 0\)</span> because
<span class="math display">\[
0 = \int p(x)^2 d\nu(x) = \mathrm{vec}(p)^\top M_t[y] \mathrm{vec}(p).
\]</span>
We now look for polynomials from the null space (or kernel) of <span class="math inline">\(M_t[y]\)</span>, for which we denote <span class="math inline">\(\mathrm{ker}(M_t[y])\)</span>. Consider the ideal
<span class="math display">\[
I := \mathrm{Ideal}[ \{ p \in \mathbb{R}[x]_t \mid \mathrm{vec}(p) \in \mathrm{ker}(M_t[y]) \} ].
\]</span>
We will show that we can construct a basis for the quotient space <span class="math inline">\(\mathbb{R}[x] / I\)</span>.</p>
<p>Let the spectral decomposition of <span class="math inline">\(M_t[y]\)</span> be
<span class="math display">\[
M_t[y] = V \Lambda V^\top, \quad V \in \mathbb{R}^{s(n,t) \times r}.
\]</span>
Clearly, the kernel of <span class="math inline">\(M_t[y]\)</span> is the same as the null space of <span class="math inline">\(V^\top\)</span>:
<span class="math display">\[
\mathrm{ker}(M_t[y]) = \mathrm{ker}(V^\top).
\]</span>
Therefore, to get the kernel of <span class="math inline">\(M_t[y]\)</span>, we can first put <span class="math inline">\(V^\top\)</span> into <a href="https://en.wikipedia.org/wiki/Row_echelon_form#:~:text=row%20echelon%20form-,A%20matrix%20is%20in%20row%20echelon%20form%20if,entry%20of%20every%20row%20above.">reduced row echelon form</a> (RREF, for a square matrix, the RREF can be thought of as the upper triangular form), e.g., using the Matlab <a href="https://www.mathworks.com/help/matlab/ref/rref.html"><code>rref</code></a> function:
<span class="math display">\[
U = \begin{bmatrix}
1 &amp; * &amp; 0 &amp; 0 &amp; * &amp; \cdots &amp; 0 &amp; * &amp; * &amp; * \\
&amp; &amp; 1 &amp; 0 &amp; * &amp; \cdots &amp; 0 &amp; * &amp; * &amp; * \\
  &amp; &amp; &amp; 1 &amp; * &amp; \cdots &amp; 0 &amp; * &amp; * &amp; * \\
    &amp; &amp; &amp;  &amp;  &amp; \cdots &amp; 0 &amp; * &amp; * &amp; * \\
      &amp; &amp; &amp;  &amp;  &amp; \ddots &amp; 0 &amp; * &amp; * &amp; * \\
      &amp; &amp; &amp;  &amp;  &amp;  &amp; 1 &amp; * &amp; * &amp; *
\end{bmatrix} \in \mathbb{R}^{r \times s(n,t)}.
\]</span>
The columns of <span class="math inline">\(U\)</span> are labeled by the standard monomials <span class="math inline">\(x^{\alpha}, \alpha \in \mathcal{F}_{n,t}\)</span>. The RREF <span class="math inline">\(U\)</span> has <span class="math inline">\(r\)</span> pivot columns (columns having the first nonzero element in each row), say labelled by
<span class="math display">\[
B_0 = \{ \beta_1, \dots, \beta_r \}, \quad \beta_i \in \mathcal{F}_{n,t}, i=1,\dots,t.
\]</span>
Let <span class="math inline">\(e_i\)</span> be the standard basis vector with all zeros except <span class="math inline">\(1\)</span> at the <span class="math inline">\(i\)</span>-th row, form the new set
<span class="math display">\[
B_1 := (e_1 + B_0) \cup \dots \cup (e_n + B_0) \backslash B_0.
\]</span></p>
<p>The following result shows that we can obtain all the solutions <span class="math inline">\(x_1,\dots,x_r\)</span> by solving a system of polynomial equations.</p>
<div class="theorembox">
<div class="lemma">
<p><span id="lem:ExtractingSolutions" class="lemma"><strong>Lemma 5.1  (Extracting Solutions) </strong></span>Suppose the flat extension condition holds for <span class="math inline">\(y \in \mathbb{R}^{s(n,2t)}\)</span>, then,
<span class="math display">\[
\mathbb{R}[x]/I = \mathrm{span}\{ [x^{\beta_1}], \dots, [x^{\beta_r}] \},
\]</span>
and the points <span class="math inline">\(x_1,\dots,x_r\)</span> in <span class="math inline">\(\mathrm{supp}(\nu)\)</span> are precisely solutions to the following polynomial system of equations
<span class="math display" id="eq:extract-solution-polynomial-system">\[\begin{equation}
p_{\alpha}(x) = x^{\alpha} - \sum_{j=1}^r U(j,\alpha) x^{\beta_j} = 0, \quad \alpha \in B_1.
\tag{5.25}
\end{equation}\]</span></p>
</div>
</div>
<p>The fact that all the polynomials <span class="math inline">\(p_{\alpha}(x), \alpha \in B_1\)</span> are in the null space of <span class="math inline">\(M_t[y]\)</span> can be deduced from the RREF <span class="math inline">\(U\)</span>, e.g., you can see <a href="https://people.math.carleton.ca/~kcheung/math/notes/MATH1107/wk09/09_basis_for_nullspace.html">this webpage about how to find the null space of an RREF</a>.</p>
<!-- On the other hand, we can perform a rank-$r$ factorization of the moment matrix $M_t[y]$
$$
M_t[y] = V V\tran,
$$
for some $V \in \Real{s(n,t) \times r}$. For example, this can be done by eigen decomposition or Cholesky factorization. Clearly, $V$ and $V_\star$ span the same linear subspace (the orthogonal complement of the kernel of the moment matrix $M_t[y]$, also we know the space spanned by $V_\star$ has the basis $[x_1]_t,\dots,[x_r]_t$). So the general ideal here is to find a set of basis of the space spanned by $V$ first and then establish connections between the that set of basis with another set of basis $[x_1]_t,\dots,[x_r]_t$.

We can first reduce $V$ to column echelon form:
$$
U = \begin{bmatrix}
1 & & & & \\
* & & & & \\
0 & 1 & & & \\
0 & 0 & 1 & & \\
* & * & * & & \\
 & \vdots & & \ddots & \\
 0 & 0 & 0 & \cdots & 1 \\
 * & * & * & \cdots & * \\
 * & \vdots & & & \vdots \\
 * & * & * & \cdots & *  
\end{bmatrix} \in \Real{s(n,t) \times r}
$$
where each "$*$" indicates a nonzero element. By construction of the moment matrix, each row of $V$ and $U$ is indexed by a monomial $x^{\alpha} \in [x]_t$. Pivot elements in $U$, i.e., the first nonzero element in each column of $U$, correspond to monomials $x^{\beta_j},j=1,\dots,r$. Let these monomials form a basis 
$$
w(x) = \begin{bmatrix}
x^{\beta_1} \\ \vdots \\ x^{\beta_r},
\end{bmatrix}
$$
then we have 
\begin{equation}
[x]_t = U w(x)
(\#eq:extract-solution-polynomial-system)
\end{equation}
for all $x_i,i=1,\dots,r$. This is a system of $s(n,t)$ polynomial equations.  -->
<p>Our goal now becomes to find all the roots of the system <a href="Moment.html#eq:extract-solution-polynomial-system">(5.25)</a>. This is something we learned how to solve in Chapter <a href="SOS.html#ZeroDimIdeal">4.1.5</a>! Specifically, the basic strategy is to first find the multiplication matrices, and then simultaneously diagonalize them, or use a more robust procedure suggested in <span class="citation">(<a href="#ref-corless1997reordered">Corless, Gianni, and Trager 1997b</a>)</span>, which I asked you to practice in one of the problem sets.</p>
<p>Let us make this solution extraction procedure concrete by going through an example.</p>
<div class="examplebox">
<div class="example">
<p><span id="exm:SolutionExtraction" class="example"><strong>Example 5.3  (Solution Extraction from Moment Matrix) </strong></span>Consider the polynomial optimization problem
<span class="math display">\[\begin{equation}
\begin{split}
\min_{x \in \mathbb{R}^{2}} &amp; \quad (x_1 - 1)^2 + (x_1 - x_2)^2 + (x_2 - 3)^2 \\
\mathrm{s.t.}&amp; \quad 1 - (x_1 - 1)^2 \geq 0 \\
&amp; \quad 1 - (x_1 - x_2)^2 \geq 0 \\
&amp; \quad 1 - (x_2 - 3)^2 \geq 0
\end{split}
\end{equation}\]</span>
Solving the moment relaxation with <span class="math inline">\(\kappa =2\)</span>, we obtain
<span class="math display">\[
\mathrm{rank}(M_1[y]) = \mathrm{rank}(M_2[y]) = 3.
\]</span>
Therefore, there exist three global optimizers. The moment matrix reads
<span class="math display">\[
M_2[y] = \begin{bmatrix}
1.0000 &amp; 1.5868 &amp; 2.2477 &amp; 2.7603 &amp; 3.6690 &amp; 5.2387 \\
1.5868 &amp; 2.7603 &amp; 3.6690 &amp; 5.1073 &amp; 6.5115 &amp; 8.8245 \\
2.2477 &amp; 3.6690 &amp; 5.2387 &amp; 6.5115 &amp; 8.8245 &amp; 12.7072 \\
2.7603 &amp; 5.1073 &amp; 6.5115 &amp; 9.8013 &amp; 12.1965 &amp; 15.9960 \\
3.6690 &amp; 6.5115 &amp; 8.8245 &amp; 12.1965 &amp; 15.9960 &amp; 22.1084 \\
5.2387 &amp; 8.8245 &amp; 12.7072 &amp; 15.9960 &amp; 22.1084 &amp; 32.1036
\end{bmatrix}
\]</span>
whose rows and columns are indexed by the standard monomial basis
<span class="math display">\[
[x]_2 = \begin{bmatrix}
1 \\ x_1 \\ x_2 \\ x_1^2 \\ x_1 x_2 \\ x_2^2
\end{bmatrix}.
\]</span>
We can factorize <span class="math inline">\(M_2[y]\)</span> as <span class="math inline">\(VV^\top\)</span> with
<span class="math display">\[
V = \begin{bmatrix}
-0.9384 &amp; - 0.0247 &amp; 0.3447 \\
-1.6188 &amp; 0.3036 &amp; 0.2182 \\
-2.2486 &amp; -0.1822 &amp; 0.3864 \\
-2.9796 &amp; 0.9603 &amp; -0.0348 \\
-3.9813 &amp; 0.3417 &amp; -0.1697 \\
-5.6128 &amp; -0.7627 &amp; -0.1365
\end{bmatrix}.
\]</span>
Reduce <span class="math inline">\(V\)</span> to column echelon form (which is equivalent to reduce <span class="math inline">\(V^\top\)</span> to row echelon form)
<span class="math display">\[
U = \begin{bmatrix}
1 &amp; &amp; \\
0 &amp; 1 &amp; \\
0 &amp; 0 &amp; 1 \\
-2 &amp; 3 &amp; 0 \\
-4 &amp; 2 &amp; 2 \\
-6 &amp; 0 &amp; 5
\end{bmatrix}.
\]</span>
Pivot entries of <span class="math inline">\(U\)</span> correspond to the following monomial basis
<span class="math display">\[
w(x) = \begin{bmatrix} 1\\ x_1 \\ x_2 \end{bmatrix}.
\]</span>
The polynomial system of equations <span class="math inline">\([x]_2 = U w(x)\)</span> reads
<span class="math display">\[\begin{equation}
\begin{split}
x_1^2 &amp;= -2 + 3x_1 \\
x_1 x_2 &amp;= -4 + 2x_1 + 2x_2 \\
x_2^2 &amp;= -6 + 5x_2
\end{split}
\end{equation}\]</span>
Multiplication matrices, by <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, can be extracted from <span class="math inline">\(U\)</span>:
<span class="math display">\[
x_1 \cdot w(x) = \begin{bmatrix}
0 &amp; 1 &amp; 0 \\
-2 &amp; 3 &amp; 0 \\
-4 &amp; 2 &amp; 2
\end{bmatrix} w(x) = M_1 w(x)
\]</span>
<span class="math display">\[
x_2 \cdot w(x) = \begin{bmatrix}
0 &amp; 0 &amp; 1 \\
-4 &amp; 2 &amp; 2\\
-6 &amp; 0 &amp; 5
\end{bmatrix} w(x) = M_2 w(x).
\]</span>
Perform a generic linear combination of <span class="math inline">\(M_1\)</span> and <span class="math inline">\(M_2\)</span>:
<span class="math display">\[
M = 3 M_1 + 4 M_2,
\]</span>
and then find its Schur decomposition
<span class="math display">\[
U^* M U = T = \begin{bmatrix}
18.0000  &amp; -36.3731  &amp; -30.0892\\
0   &amp; 11.0000   &amp; -0.8018 \\
0         &amp; 0   &amp; 14.0000
\end{bmatrix}, \quad U = \begin{bmatrix}
-0.2673   &amp; -0.7715   &amp; -0.5774\\
-0.5345    &amp; 0.6172   &amp; -0.5774\\
-0.8018   &amp;-0.1543    &amp; 0.5774
\end{bmatrix}.
\]</span>
Then we perform
<span class="math display">\[
U^* M_1 U = \begin{bmatrix}
2.0000  &amp;  -5.1962   &amp; -1.3887 \\
    0.0000    &amp; 1.0000   &amp; -0.2673\\
   0.0000    &amp; 0.0000   &amp; 2.0000
\end{bmatrix}, \quad
U^* M_2 U = \begin{bmatrix}
3.0000   &amp; -5.1962   &amp; -6.4807\\
    0.0000    &amp; 2.0000    &amp; 0.0000\\
    0.0000   &amp; -0.0000    &amp; 2.0000
\end{bmatrix}
\]</span>
from which the three global optimizers can be found:
<span class="math display">\[
x(1) = \begin{bmatrix} 2 \\ 3 \end{bmatrix}, \quad
x(2) = \begin{bmatrix} 1 \\ 2 \end{bmatrix}, \quad
x(3) = \begin{bmatrix} 2 \\ 2 \end{bmatrix}.
\]</span></p>
</div>
</div>
</div>
<div id="conversion-to-standard-sdp" class="section level2 hasAnchor" number="5.7">
<h2><span class="header-section-number">5.7</span> Conversion to Standard SDP<a href="Moment.html#conversion-to-standard-sdp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="the-first-approach" class="section level3 hasAnchor" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> The First Approach<a href="Moment.html#the-first-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The moment relaxation <a href="Moment.html#eq:moment-Putinar">(5.14)</a> at the <span class="math inline">\(\kappa\)</span>-th relaxation order can be written as
<span class="math display" id="eq:moment-Putinar-y">\[\begin{equation}
\begin{split}
\max_{y \in \mathbb{R}^{s(n,2\kappa)}} &amp; \quad \langle - \mathrm{vec}(p), y \rangle \\
\mathrm{s.t.}&amp; \quad y_0 = 1 \\
&amp; \quad M_\kappa[y] \succeq 0 \\
&amp; \quad L_{g_i}^{\kappa}[y] \succeq 0, i=1,\dots,l_g \\
&amp; \quad L_{h_i}^{2\kappa}[y] = 0, i=1,\dots,l_h
\end{split},
\tag{5.26}
\end{equation}\]</span>
where I have converted the <span class="math inline">\(\min\)</span> to <span class="math inline">\(\max\)</span>. We now sketch how we can write problem <a href="Moment.html#eq:moment-Putinar-y">(5.26)</a> as a standard conic optimization problem described in Chapter <a href="sdp.html#SoftwareConic">2.3</a>, in particular the dual conic problem <a href="sdp.html#eq:dual-conic">(2.8)</a>.</p>
<p>First, we can write the moment matrix as
<span class="math display">\[
M_{\kappa}[y] = \sum_{\alpha \in \mathcal{F}_{n,2\kappa}} y_\alpha B_{\alpha}, \quad B_{\alpha} \in \mathbb{S}^{s(n,\kappa)}, \forall \alpha \in \mathcal{F}_{n,2\kappa},
\]</span>
where <span class="math inline">\(B_\alpha\)</span> are constant (sparse) matrices. For example, for the moment matrix <a href="Moment.html#eq:example-second-order-moment-mat">(5.2)</a> in Example <a href="Moment.html#exm:MomentMatrix">5.1</a>, <span class="math inline">\(B_\alpha\)</span> corresponding to the exponent <span class="math inline">\((1,1)\)</span> is
<span class="math display">\[
B_{11} = \begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0
\end{bmatrix}.
\]</span>
One interesting property is
<span class="math display">\[
\langle B_\alpha, B_\beta \rangle = 0, \quad \forall \alpha \neq \beta,
\]</span>
simply because <span class="math inline">\(y_\alpha\)</span> and <span class="math inline">\(y_\beta\)</span> does not appear in the same location of the moment matrix.</p>
<p>Similarly, we can write each localizing matrix <span class="math inline">\(L_{g_i}^\kappa[y]\)</span> as
<span class="math display">\[
L_{g_i}^{\kappa}[y] = \sum_{\alpha \in \mathcal{F}_{n,2\kappa}} y_{\alpha} B^{g_i}_\alpha, \quad B_{\alpha}^{g_i} \in \mathbb{S}^{s(n,s_i)}, s_i = \lfloor  (2\kappa - \deg(g_i))/2  \rfloor,i=1,\dots,l_g,
\]</span>
where <span class="math inline">\(B_{\alpha}^{g_i}\)</span> are constant matrices. For example, for the localizing matrix in <a href="Moment.html#eq:example-localizing-matrix">(5.6)</a>, <span class="math inline">\(B_\alpha^g\)</span> of the exponent <span class="math inline">\(\alpha = (2,2)\)</span> is
<span class="math display">\[
B_{22}^{g} = \begin{bmatrix}
0 &amp; 0 &amp; 0 \\
0 &amp; -1 &amp; 0 \\
0 &amp; 0 &amp; -1
\end{bmatrix}.
\]</span></p>
<p>Lastly, the localizing vector is simply
<span class="math display">\[
L_{h_i}^{2\kappa}[y] = (H^{2\kappa}_i)^\top y, \quad H^{2\kappa}_i \in \mathbb{R}^{s(n,2\kappa) \times s(n,t_i)}, t_i = 2\kappa - \deg(h_i), i=1,\dots,l_h.
\]</span></p>
<p>With these, we can write problem <a href="Moment.html#eq:moment-Putinar-y">(5.26)</a> as
<span class="math display" id="eq:moment-Putinar-y-1">\[\begin{equation}
\begin{split}
\max_{y \in \mathbb{R}^{s(n,2\kappa)}} &amp; \quad \langle - \mathrm{vec}(p), y \rangle \\
\mathrm{s.t.}&amp; \quad \sum_{\alpha \in \mathcal{F}_{n,2\kappa}} y_\alpha B_\alpha \succeq 0 \\
&amp; \quad \sum_{\alpha \in \mathcal{F}_{n,2\kappa}} y_\alpha B_\alpha^{g_i} \succeq 0, \quad i=1,\dots,l_g \\
&amp; \quad \underbrace{\begin{bmatrix} 1 \\
0 \\ \vdots \\ 0 \end{bmatrix}}_{f} - \underbrace{\begin{bmatrix}
e_1^\top\\
(H^{2\kappa}_1)^\top\\
\vdots \\
(H^{2\kappa}_{l_h})^\top
\end{bmatrix}}_{F} y = 0
\end{split}
\tag{5.27}
\end{equation}\]</span>
where <span class="math inline">\(e_1\)</span> is the all-zero vector except the first entry equal to <span class="math inline">\(1\)</span>.</p>
<p>Now consider the vector space
<span class="math display">\[
\mathcal{V}= \mathbb{S}^{s(n,\kappa)} \times \mathbb{S}^{s(n,s_1)} \times \cdots \times \mathbb{S}^{s(n,s_{l_g})} \times \mathbb{R}^{t}, \quad t:= 1 + s(n,t_1) + \dots + s(n,t_{l_h}),
\]</span>
and the cone within <span class="math inline">\(\mathcal{V}\)</span>
<span class="math display">\[
\mathcal{K}= \mathbb{S}^{s(n,\kappa)}_{+} \times \mathbb{S}^{s(n,s_1)}_{+} \times \cdots \times \mathbb{S}^{s(n,s_{l_g})}_{+} \times 0^{t}.
\]</span></p>
<p>Consider the function <span class="math inline">\(\phi: \mathbb{R}^{s(n,2\kappa)} \rightarrow \mathcal{V}\)</span> defined as
<span class="math display" id="eq:moment-Putinar-adjoint">\[\begin{equation}
\phi(y) = \left( -\sum_{\alpha} y_\alpha B_\alpha, -\sum_{\alpha} y_\alpha B_\alpha^{g_1}, \cdots, -\sum_{\alpha} y_\alpha B_{\alpha}^{g_{l_g}}, Fy   \right) \in \mathcal{V}
\tag{5.28}
\end{equation}\]</span>
and the vector
<span class="math display">\[
C = \left(0,0,\cdots,0,f \right) \in \mathcal{V}.
\]</span></p>
<p>Observe that problem <a href="Moment.html#eq:moment-Putinar-y-1">(5.27)</a> is now in standard dual conic form
<span class="math display" id="eq:moment-Putinar-dual-conic-form">\[\begin{equation}
\begin{split}
\max_{y \in \mathbb{R}^{s(n,2\kappa)}} &amp; \quad \langle -\mathrm{vec}(p), y \rangle \\
\mathrm{s.t.}&amp; \quad C - \phi(y) \in \mathcal{K}.
\end{split}
\tag{5.29}
\end{equation}\]</span></p>
<p>We can also write the primal conic form of <a href="Moment.html#eq:moment-Putinar-dual-conic-form">(5.29)</a> using standard conic duality. The linear map <span class="math inline">\(\phi(y)\)</span> in <a href="Moment.html#eq:moment-Putinar-adjoint">(5.28)</a> can be written as
<span class="math display">\[
\phi(y) = \sum_{\alpha} y_{\alpha} A_{\alpha},
\]</span>
with
<span class="math display">\[
A_{\alpha} = \left( -B_{\alpha}, - B_{\alpha}^{g_1}, \cdots, - B_{\alpha}^{g_{l_g}}, f_{\alpha} \right) \in \mathcal{V}, \quad \alpha \in \mathcal{F}_{n,2\kappa},
\]</span>
where <span class="math inline">\(f_{\alpha}\)</span> is the column of <span class="math inline">\(F\)</span> indexed by the exponent <span class="math inline">\(\alpha\)</span>. With the dual cone of <span class="math inline">\(\mathcal{K}\)</span> being
<span class="math display">\[
\mathcal{K}^* = \mathbb{S}^{s(n,\kappa)}_{+} \times \mathbb{S}^{s(n,s_1)}_{+} \times \cdots \times \mathbb{S}^{s(n,s_{l_g})}_{+} \times \mathbb{R}^{t},
\]</span>
the primal conic form of <a href="Moment.html#eq:moment-Putinar-dual-conic-form">(5.29)</a> reads
<span class="math display" id="eq:moment-Putinar-primal-conic-form">\[\begin{equation}
\begin{split}
\min_{X \in \mathcal{V}} &amp; \quad \langle C, X \rangle \\
\mathrm{s.t.}&amp; \quad \langle A_\alpha, X \rangle = - p_{\alpha}, \quad \alpha \in \mathcal{F}_{n,2\kappa} \\
&amp; \quad X \in \mathcal{K}^*
\end{split}
\tag{5.30}
\end{equation}\]</span>
It is not too difficult to observe that the primal conic form <a href="Moment.html#eq:moment-Putinar-primal-conic-form">(5.30)</a> is just the conic representation of the dual SOS program <a href="Moment.html#eq:SOS-Putinar-restate">(5.13)</a>, because the linear constraints in <a href="Moment.html#eq:moment-Putinar-primal-conic-form">(5.30)</a> are exactly those that match the coefficients of the two polynomials “<span class="math inline">\(p(x)\)</span>” and “<span class="math inline">\(\gamma + \mathrm{Ideal}[h]_{2\kappa} + \mathrm{Qmodule}[g]_{2\kappa}\)</span>”.</p>
</div>
<div id="the-second-approach" class="section level3 hasAnchor" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> The Second Approach<a href="Moment.html#the-second-approach" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first conversion approach generates <span class="math inline">\(X \in \mathcal{K}\)</span>, which contains not only PSD variables but also free variables. In the second approach, we can generate a conic program with only PSD variables.</p>
<p><strong>Rewriting the moment matrix</strong>. To do so, I will first create a variable <span class="math inline">\(X_{\mathrm{mom}} \in \mathbb{S}^{s(n,\kappa)}\)</span> and enforce it to be a valid moment matrix by using linear constraints. This is equivalent to saying
<span class="math display" id="eq:X-mom-decomposition">\[\begin{equation}
X_{\mathrm{mom}} = \sum_{\alpha} y_{\alpha} B_{\alpha},
\tag{5.31}
\end{equation}\]</span>
for some <span class="math inline">\(y \in \mathbb{R}^{s(n,2\kappa)}\)</span>, or in other words
<span class="math display">\[
X_{\mathrm{mom}} \in B := \mathrm{span}\{ B_{\alpha} \}_{\alpha \in \mathcal{F}_{n,2\kappa}} \subset \mathbb{S}^{s(n,\kappa)}
\]</span>
i.e., <span class="math inline">\(X_{\mathrm{mom}}\)</span> lives in the subspace <span class="math inline">\(B\)</span> of dimension/rank <span class="math inline">\(s(n,2\kappa)\)</span>. The dimension of <span class="math inline">\(\mathbb{S}^{s(n,\kappa)}\)</span> is
<span class="math display">\[
s(n,\kappa)^{\Delta} := \frac{s(n,\kappa) (s(n,\kappa) +1)}{2}.
\]</span>
Therefore, denote the orthogonal complement of <span class="math inline">\(B\)</span> as <span class="math inline">\(B^{\perp}\)</span> with dimension
<span class="math display">\[
d(n,\kappa) := \dim (B^{\perp}) = s(n,\kappa)^{\Delta} - s(n,2\kappa),
\]</span>
and a (potentially orthonormal) set of basis of <span class="math inline">\(B^{\perp}\)</span> as
<span class="math display">\[
\{ B^{\perp}_{1}, \dots, B^{\perp}_{d(n,\kappa)}  \}.
\]</span>
Then <span class="math inline">\(X_{\mathrm{mom}}\)</span> admitting a moment matrix representation <a href="Moment.html#eq:X-mom-decomposition">(5.31)</a> is equivalent to a set of linear constraints
<span class="math display" id="eq:moment-matrix-valid-constraints">\[\begin{equation}
\langle B^{\perp}_{i},  X_{\mathrm{mom}}  \rangle = 0, i=1,\dots, d(n,\kappa).
\tag{5.32}
\end{equation}\]</span>
In addition, we have
<span class="math display" id="eq:from-X-mom-to-y-mom">\[\begin{equation}
\langle B_{\alpha}, X_{\mathrm{mom}} \rangle = \left\langle B_{\alpha}, \sum_{\beta}y_{\beta} B_{\beta}  \right\rangle = c_{\alpha} y_{\alpha}, \quad \alpha \in \mathcal{F}_{n,2\kappa},
\tag{5.33}
\end{equation}\]</span>
where <span class="math inline">\(c_{\alpha} := \Vert B_{\alpha} \Vert_\mathrm{F}^2\)</span> is a constant. Therefore, the constraint <span class="math inline">\(y_0 = 1\)</span> can be easily written as
<span class="math display" id="eq:moment-matrix-one-constraint">\[\begin{equation}
\langle B_0, X_{\mathrm{mom}} \rangle = 1
\tag{5.34}
\end{equation}\]</span>
because <span class="math inline">\(\Vert B_0 \Vert_\mathrm{F}^2 = 1\)</span>.</p>
<p><strong>Adding localizing vector constraints</strong>. Next we look at the constraints that the localizing vectors must be zero:
<span class="math display">\[
\bar{F}y =
\begin{bmatrix}
(H_1^{2\kappa})^\top\\
\vdots \\
(H_{l_h}^{2\kappa})^\top
\end{bmatrix} y = 0, \quad \bar{F} \in \mathbb{R}^{\bar{t} \times s(n,2\kappa)}, \bar{t}:=t-1.
\]</span>
Using <a href="Moment.html#eq:from-X-mom-to-y-mom">(5.33)</a>, this is equivalent to another set of linear constraints on the moment matrix
<span class="math display" id="eq:moment-matrix-localizing-vector-constraints">\[\begin{equation}
\bar{F} \begin{bmatrix}
\vdots \\
\langle B_{\alpha}, X_{\mathrm{mom}} \rangle\\
\vdots
\end{bmatrix} = 0 \quad \Leftrightarrow \quad \langle H_i, X_{\mathrm{mom}} \rangle = 0, i=1,\dots,\bar{t}
\tag{5.35}
\end{equation}\]</span>
with (if you want explict expressions of <span class="math inline">\(H_i\)</span>’s)
<span class="math display">\[
H_i := \sum_{\alpha \in \mathcal{F}_{n,2\kappa}} \bar{F}_{i,\alpha} B_{\alpha}, \quad i=1,\dots,\bar{t}
\]</span>
where <span class="math inline">\(\bar{F}_{i,\alpha}\)</span> is the <span class="math inline">\((i,\alpha)\)</span> entry of <span class="math inline">\(\bar{F}\)</span>.</p>
<p><strong>Adding localizing matrices</strong>. Finally, we create additional variables for the localizing matrices
<span class="math display">\[
X_{\mathrm{loc},1},\dots,X_{\mathrm{loc},l_g},
\]</span>
and enforce that their entries are linear combinations of the moments. Recall that a localizing matrix is
<span class="math display">\[
L_{g_i}^{\kappa}[y] = \ell_y \left( g_i(x)\cdot [x]_{s_i}[x]_{s_i}^\top\right).
\]</span>
Writing <span class="math inline">\(g_i(x) = \sum_\gamma g_{i,\gamma} x^{\gamma}\)</span>, this means the <span class="math inline">\((\alpha,\beta)\)</span> entry of <span class="math inline">\(L_{g_i}^{\kappa}[y]\)</span> is
<span class="math display">\[
\sum_{\gamma} g_{i,\gamma} y_{\alpha+\beta+\gamma}, \quad \alpha,\beta \in \mathcal{F}_{n,s_i}.
\]</span>
Therefore, for each localizing matrix, we have the constraint
<span class="math display" id="eq:moment-matrix-localizing-matrix-constraints">\[\begin{equation}
\langle B_{i,\alpha,\beta}, X_{\mathrm{loc},i} \rangle = X_{\mathrm{loc},i,\alpha,\beta} = \langle G_{i,\alpha,\beta}, X_{\mathrm{mom}} \rangle, \quad i=1,\dots,l_g, \alpha,\beta \in \mathcal{F}_{n,s_i}, \alpha \succeq \beta,
\tag{5.36}
\end{equation}\]</span>
where (if you want explict expressions of <span class="math inline">\(G_{i,\alpha,\beta}\)</span>)
<span class="math display">\[
G_{i,\alpha,\beta} = \sum_{\gamma} \frac{1}{c_{\alpha+\beta+\gamma}} g_{i,\gamma} B_{\alpha+\beta+\gamma}.
\]</span></p>
<p><strong>The cost function</strong>. Finally, the cost function is
<span class="math display">\[
\sum_{\alpha} p_{\alpha} y_{\alpha} = \sum_{\alpha} \frac{p_{\alpha}}{c_{\alpha}} \langle B_{\alpha}, X_{\mathrm{mom}} \rangle = \left\langle \sum_{\alpha} \frac{p_{\alpha}}{c_{\alpha}} B_{\alpha} , X_{\mathrm{mom}} \right\rangle := \langle C_{\mathrm{mom}}, X_{\mathrm{mom}} \rangle.
\]</span></p>
<p><strong>Putting everything together</strong>. The moment relaxation <a href="Moment.html#eq:moment-Putinar-y">(5.26)</a> can be written as a standard primal SDP
<span class="math display" id="eq:moment-Putinar-standard-primal-SDP">\[\begin{equation}
\begin{split}
\min_{\substack{X_{\mathrm{mom}} \\ X_{\mathrm{loc},1},\dots,X_{\mathrm{loc},l_g}} } &amp; \quad \langle C_{\mathrm{mom}}, X_{\mathrm{mom}} \rangle \\
\mathrm{s.t.}&amp; \quad \langle B_0, X_{\mathrm{mom}} \rangle = 1 \\
&amp; \quad \langle B_i^{\perp}, X_{\mathrm{mom}} \rangle = 0, \quad i=1,\dots,d(n,\kappa) \\
&amp; \quad \langle H_i, X_{\mathrm{mom}} \rangle = 0, \quad i=1,\dots,\bar{t} \\
&amp; \quad \langle B_{i,\alpha,\beta}, X_{\mathrm{loc},i} \rangle - \langle G_{i,\alpha,\beta}, X_{\mathrm{mom}} \rangle = 0, \quad i=1,\dots,l_g, \alpha\succeq\beta \in \mathcal{F}_{n,s_i} \\
&amp; \quad X_{\mathrm{mom}},X_{\mathrm{loc},1},\dots,X_{\mathrm{loc},l_g} \succeq 0
\end{split}
\tag{5.37}
\end{equation}\]</span></p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bayer06ams-proof" class="csl-entry">
Bayer, Christian, and Josef Teichmann. 2006. <span>“The Proof of Tchakaloff’s Theorem.”</span> <em>Proceedings of the American Mathematical Society</em> 134 (10): 3035–40.
</div>
<div id="ref-corless1997reordered" class="csl-entry">
———. 1997b. <span>“A Reordered Schur Factorization Method for Zero-Dimensional Polynomial Systems with Multiple Roots.”</span> In <em>Proceedings of the 1997 International Symposium on Symbolic and Algebraic Computation</em>, 133–40.
</div>
<div id="ref-curto05jot-truncated" class="csl-entry">
Curto, Raúl E, and Lawrence A Fialkow. 2005. <span>“Truncated k-Moment Problems in Several Variables.”</span> <em>Journal of Operator Theory</em>, 189–226.
</div>
<div id="ref-henrion05ppc-detecting" class="csl-entry">
Henrion, Didier, and Jean-Bernard Lasserre. 2005. <span>“Detecting Global Optimality and Extracting Solutions in GloptiPoly.”</span> In <em>Positive Polynomials in Control</em>, 293–310. Springer.
</div>
<div id="ref-lasserre01siopt-global" class="csl-entry">
Lasserre, Jean B. 2001. <span>“Global Optimization with Polynomials and the Problem of Moments.”</span> <em>SIAM Journal on Optimization</em> 11 (3): 796–817.
</div>
</div>
<div id="disqus_thread"></div>
<script>
    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://semidefinite.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            </section>

          </div>
        </div>
      </div>
<a href="SOS.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hankyang94/Semidefinite/blob/main/05-MomentRelaxation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["semidefinite-optimization-relaxation.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
